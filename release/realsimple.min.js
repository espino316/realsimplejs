function RS(){function manageRoutes(locationHash){if("#"!=locationHash&&""!==locationHash){if(locationHashBusy=!0,"undefined"!==self.config.routes&&null!==self.config.routes){locationHash=(locationHash=String(locationHash)).replace("#","");var segmentsUrl,map,action,regParam=new RegExp(":[a-zA-Z0-9]+","gi"),params=null,urlFormat=null,url=null,newUrl=null,fnEach=function(item,key,collection){var tmp=key;null!==(params=key.match(regParam))?(params.forEach(function(str,idx,collection){key=key.replace(str,"[a-zA-Z0-9]+")}),null!==new RegExp(key,"i").exec(locationHash)&&(urlFormat=tmp,url=locationHash,newUrl=item)):key==locationHash&&(urlFormat=key,url=locationHash,newUrl=item)},segmentsUrlFormat=(new RSObject(self.config.routes).forEach(fnEach),null!==urlFormat?(segmentsUrlFormat=urlFormat.split("/"),segmentsUrl=url.split("/"),map={},segmentsUrlFormat.forEach(function(item,index,collection){map[item]=segmentsUrl[index]}),fnEach=function(item,index,collection){newUrl=newUrl.replaceAll(item,map[item])},null!==(params=urlFormat.match(regParam))&&params.forEach(fnEach)):(console.warn(locationHash+" no route found."),newUrl=locationHash),newUrl.split("/"));if(2<=segmentsUrlFormat.length)return fnEach=segmentsUrlFormat[0],action=segmentsUrlFormat[1],segmentsUrlFormat.splice(0,2),void 0===window[fnEach]?console.error("Controlador no definido ["+fnEach+"]"):void 0===window[fnEach][action]?console.error("Funcion no definida ["+fnEach+"."+action+"]"):window[fnEach][action].apply(this,segmentsUrlFormat),locationHashBusy=!1}locationHashBusy=!1}}var self=this,locationHashBusy=(this.config=null,!1),storedHash=window.location.hash,hashChangedTick=(self.assignValue=function(bindable,value){var parts,code;null!==bindable&&null!==value&&("string"==typeof value&&"{}"!=value&&"null"!=value&&(value="'"+value+"'"),parts=bindable.split("."),code="",1<parts.length?(code="window",parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=" = "+value+";"):code=bindable+" = "+value+";",new Function(code)())},self.returnValue=function(bindable){var parts;return null===bindable?null:0<(parts=bindable.split(".")).length?this.evalUndefined(parts[0])||this.evalUndefined(bindable)?null:new Function("return "+bindable+";")():this.evalUndefined(bindable)?null:void 0},self.evalUndefined=function(bindable){return new Function("return ( typeof "+bindable+" == 'undefined' );")()},self.defineGetter=function(obj,propName,fnGet){var parts=obj.split("."),code="";1<parts.length?(code="window",parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=".__defineGetter__( propName, fnGet );"):code+="window['"+obj+"'].__defineGetter__( propName, fnGet );",new Function("propName","fnGet",code)(propName,fnGet)},self.defineSetter=function(obj,propName,fnSet){var parts=obj.split("."),code="";1<parts.length?(code="window",parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=".__defineSetter__( propName, fnSet );"):code+="window['"+obj+"'].__defineSetter__( propName, fnSet );",new Function("propName","fnSet",code)(propName,fnSet)},self.forEach=function(obj,fn){switch(typeof obj){case"object":if("number"==typeof obj.length){for(var arr=[],i=0;i<obj.length;i++)arr.push(obj[i]);arr.forEach(fn)}else(obj=new RSObject(obj)).forEach(fn);break;case"array":obj.forEach(fn);break;default:return null}},self.onReady=function(fn){document.addEventListener("DOMContentLoaded",function(event){fn()})},self.removeHash=function(){window.location.hash=""},function(){var locationHash;window.location.hash!=storedHash&&(storedHash=window.location.hash,locationHash=storedHash,!1===locationHashBusy)&&manageRoutes(locationHash)});this.readConfig=function(configUrl){function onSuccess(res){if("object"==typeof(res=res.data))self.config=res;else try{var jsonResponse=JSON.parse(res),res=jsonResponse;self.config=jsonResponse}catch(ex){return console.error("Config is not json or is unavailable"),void console.error(res)}void 0!==self.config&&(void 0!==self.config.options.useRouting&&self.config.options.useRouting&&window.setInterval(hashChangedTick,300),void 0!==self.config.options.useMVC)&&self.config.options.useMVC&&dom.bindData()}var http;void 0===http&&(http=new Http);void 0!==configUrl?http.get(configUrl,null,onSuccess,function(statusText){console.error(statusText),alert(statusText)}):console.error("Configuration file undefined")}}RS.String=function(){document.createElement("textarea");this.UUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)})},this.escapeHTML=function(){var hiddenEscapeTextArea;return(hiddenEscapeTextArea=void 0===hiddenEscapeTextArea?document.createElement("textarea"):hiddenEscapeTextArea).textContent=this,hiddenEscapeTextArea.innerHTML},this.unescapeHTML=function(){var hiddenEscapeTextArea;return(hiddenEscapeTextArea=void 0===hiddenEscapeTextArea?document.createElement("textarea"):hiddenEscapeTextArea).innerHTML=this,hiddenEscapeTextArea.textContent},this.encodeUri=function(){return encodeURIComponent(this)},this.decodeUri=function(){return decodeURIComponent(this)},this.base64Encode=function(){var self=this;return self=(self=self.encodeUri()).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}),btoa(self)},this.base64Decode=function(){var self=this;try{self=atob(self)}catch(ex){return void console.error("No base 64 data")}return self=(self=(self=Array.prototype.map.call(self,function(item){return"%"+("00"+item.charCodeAt(0).toString(16)).slice(-2)})).join("")).decodeUri()},this.escapeRegExp=function(){return this.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},this.replaceAll=function(find,replace){return this.replace(new RegExp(find.escapeRegExp(),"g"),replace)},this.left=function(n){return n<=0?"":n>this.length?this:this.substring(0,n)},this.right=function(n){var iLen;return n<=0?"":n>this.length?this:(iLen=this.length,this.substring(iLen,iLen-n))},this.contains=function(str){return-1<this.indexOf(str)},this.toHex=function(){for(var hex="0x",i=0;i<this.length;i++)hex+=""+this.charCodeAt(i).toString(16);return hex},this.fromHex=function(hex){hex=hex.toString();for(var str="",i=0;i<hex.length;i+=2)str+=String.fromCharCode(parseInt(hex.substr(i,2),16));return str}},RS.Array=function(arr){var self;return(arr=arr||[]).getUnique=function(){for(var u={},a=[],i=0,l=this.length;i<l;++i)u.hasOwnProperty(this[i])||(a.push(this[i]),u[this[i]]=1);return a},arr.encodeUri=function(){var str=JSON.stringify(this);return encodeURIComponent(str)},arr.where=function(item,value){var result=[];return this.forEach(function(obj,index,arr){obj[item]==value&&result.push(obj)}),result},arr.andWhere=function(item,value){var result=[];return this.forEach(function(obj,index,arr){obj[item]==value&&result.push(obj)}),result},arr.first=function(){return this[0]},arr.like=function(item,value){var result=[];return this.forEach(function(obj,index,arr){String(obj[item]).contains(value)&&result.push(obj)}),result},arr.andLike=function(item,value){var result=[];return this.forEach(function(obj,index,arr){String(obj[item]).contains(value)&&result.push(obj)}),result},arr.indexOf=function(item,value){var result=-1;return this.forEach(function(elem,index,arr){elem[item]==value&&(result=index)}),result},arr.contains=function(value){var result=!1;return this.forEach(function(elem,index,self){elem==value&&(result=!0)}),result},void 0===arr.forEach&&(self=this,arr.forEach=function(fn){for(var len=self.length,i=0;i<len;i++)fn(self[i],i,self)}),arr.sortAsc=function(property){var row,getValue;if(0!==this.length)return void 0===(row=this[0])[property]&&console.error(property+" no part of object.",this),window.__tempFilter=property,getValue=function(v){return RS.Math.isNumeric(v)?+v:v},RS.Math.isNumeric(row[property])?this.sort(function(a,b){var filter=window.__tempFilter,a=a[filter],b=b[filter];return getValue(a)-getValue(b)}):this.sort(function(a,b){var filter=window.__tempFilter,a=a[filter],b=b[filter];return a.localeCompare(b)});console.warn("No data to sort",this,property)},arr.sortDesc=function(property){var row,getValue;if(0!==this.length)return void 0===(row=this[0])[property]&&console.error(property+" no part of object.",this),window.__tempFilter=property,getValue=function(v){return RS.Math.isNumeric(v)?+v:v},RS.Math.isNumeric(row[property])?this.sort(function(a,b){var filter=window.__tempFilter,a=a[filter],b=b[filter];return getValue(b)-getValue(a)}):this.sort(function(a,b){var filter=window.__tempFilter,a=a[filter];return b[filter].localeCompare(a)});console.warn("No data to sort",this,property)},arr.each=function(fn){try{for(var len=this.length,i=0;i<len;i++)fn(this[i],i,this)}catch(e){if(e!==RS.BreakException)throw e}},arr.sum=function(prop){var sum;if(0===this.length)return 0;if("object"!=typeof this[0])console.error("Items are not objects");else{if(this[0].hasOwnProperty(prop))return sum=0,this.forEach(function(item){sum+=Number(item[prop])}),sum;console.error("Items does not have a "+prop+" property.")}},arr},RS.DateHelper=function(){},RS.DateHelper.timestamp=function(){return Math.floor(Date.now()/1e3)},RS.DateHelper.getDateParts=function(date){var dateObj=new Date,date=(dateObj=void 0!==date?new Date(date):dateObj).getUTCMonth()+1,day=dateObj.getUTCDate(),year=dateObj.getUTCFullYear(),hour=dateObj.getUTCHours(),minutes=dateObj.getUTCMinutes(),dateObj=dateObj.getUTCSeconds(),date="00"+date,day=(date=String(date).right(2),String(day="00"+day).right(2)),newTime=(hour=String("00"+hour).right(2))+":"+(minutes=String("00"+minutes).right(2))+":"+(dateObj=String("00"+dateObj).right(2)),newDate=year+"/"+date+"/"+day,dateParts={};return dateParts.year=year,dateParts.month=date,dateParts.day=day,dateParts.hour=hour,dateParts.date=newDate,dateParts.minutes=minutes,dateParts.seconds=dateObj,dateParts.time=newTime,dateParts},RS.DateHelper.diff=function(date1,date2){var date2=parseFloat(((date2-date1)/1e3).toFixed(2)),date1=parseFloat((date2/60).toFixed(2)),hours=parseFloat((date1/60).toFixed(2)),days=parseFloat((hours/24).toFixed(2)),months=parseFloat((days/30.4167).toFixed(2));return{second:date2,minute:date1,hour:hours,day:days,month:months,year:parseFloat((months/12).toFixed(2))}},RS.DateHelper.now=function(){return(new Date).getTime()},RS.BreakException={},RS.Exception=function(message,reference){this.message=message,this.reference=reference},RS.SessionStorage=function(){};var getAll=function(){for(var i=0,len=sessionStorage.length,params={},i=0;i<len;++i){var itemValue=sessionStorage.getItem(sessionStorage.key(i)),output={};JSON.tryParse(itemValue,output)?params[sessionStorage.key(i)]=output:params[sessionStorage.key(i)]=itemValue}return params},validateWindow=function(){return window};RS.SessionStorage.set=function(itemKey,itemValue){validateWindow()?("object"==typeof itemValue&&(itemValue=JSON.stringify(itemValue)),window.sessionStorage.setItem(itemKey,itemValue)):console.log("No window. Exit RS.SessionStorage.set")},RS.SessionStorage.remove=function(itemKey){validateWindow()?window.sessionStorage.removeItem(itemKey):console.log("No window. Exit RS.SessionStorage.remove")},RS.SessionStorage.get=function(itemKey){var output;if(validateWindow())return void 0===itemKey?getAll():null===window.sessionStorage.getItem(itemKey)?(console.warn("Item "+itemKey+" do not exists"),null):(output={},itemKey=window.sessionStorage.getItem(itemKey),JSON.tryParse(itemKey,output)?output.data:itemKey);console.log("No window. Exit RS.SessionStorage.get")},RS.SessionStorage.exists=function(itemKey){if(validateWindow())return null!==window.sessionStorage.getItem(itemKey);console.log("No window. Exit RS.SessionStorage.get")},RS.Local=function(){this.set=function(itemKey,itemValue){"object"==typeof itemValue&&(itemValue=JSON.stringify(itemValue)),window.localStorage.setItem(itemKey,itemValue)},this.remove=function(itemKey){window.localStorage.removeItem(itemKey)};this.get=function(itemKey){var output;return void 0===itemKey?function(){for(var i=0,len=localStorage.length,params={},i=0;i<len;++i){var itemValue=localStorage.getItem(localStorage.key(i)),output={};JSON.tryParse(itemValue,output)?params[localStorage.key(i)]=output:params[localStorage.key(i)]=itemValue}return params}():null===window.localStorage.getItem(itemKey)?(console.warn("Item "+itemKey+" do not exists"),null):(output={},itemKey=window.localStorage.getItem(itemKey),JSON.tryParse(itemKey,output)?output.data:itemKey)},this.exists=function(itemKey){return null!==window.localStorage.getItem(itemKey)}},RS.CssRule=function(ruleName){this.ruleName=ruleName,this.properties={}},RS.CssRule.prototype.ruleName="",RS.CssRule.prototype.addProperty=function(propertyName,propertyValue){this.properties[propertyName]=propertyValue},RS.CssRule.prototype.toString=function(){for(var css="."+this.ruleName+" {\n",keys=Object.keys(this.properties),len=keys.length,i=0,i=0;i<len;i++)css=css+(keys[i]+": "+this.properties[keys[i]])+";\n";return css+="}"},RS.CssStyle=function(){},RS.CssStyle.prototype.classes=[],RS.CssStyle.prototype.addClass=function(cssClass){this.classes.push(cssClass)},RS.CssStyle.prototype.toString=function(){for(var len=this.classes.length,css="",i=0;i<len;i++)css+=this.classes[i].toString()+"\n\n";return css},RS.CssStyle.prototype.setStyle=function(){var style=document.createElement("style");style.innerHTML=this.toString(),document.getElementsByTagName("head")[0].appendChild(style)},RS.CssAnimation=function(name){this.name=name,this.from=new CssRule("from"),this.to=new CssRule("to")},RS.CssAnimation.prototype.name="",RS.CssAnimation.prototype.from=null,RS.CssAnimation.prototype.to=null,RS.CssAnimation.prototype.toString=function(){var css="@keyframes "+this.name+" {\n@from\n@to\n}",cssFrom=this.from.toString(),cssTo=this.to.toString(),cssFrom=cssFrom.replace(".from","from"),cssTo=cssTo.replace(".to","to"),wkcss=(css=(css=css.replace("@from",cssFrom)).replace("@to",cssTo),"@-webkit-keyframes "+this.name+" {\n@from\n@to\n}");return css+"\n"+(wkcss=(wkcss=wkcss.replace("@from",cssFrom)).replace("@to",cssTo))},RS.Dom=function(){var self=this,rsString=new RS.String,arrowUp=" "+rsString.unescapeHTML("&#8679;"),arrowDown=" "+rsString.unescapeHTML("&#8681;");self.submitForm=function(url,data){var form=dom.create("form");Object.keys(data).forEach(function(item,index,collection){item=function(name,value){var input=dom.create("input");return input.setAttribute("name",name),input.setAttribute("value",value),input}(item,data[item]);form.appendChild(item)}),form.setAttribute("method","post"),form.setAttribute("action",url),document.body.appendChild(form),form.submit(),document.body.removeChild(form)},self.onEnter=function(element,callback){element.onkeyup=function(){13==event.keyCode&&callback()}},self.get=function(selector){selector=document.querySelectorAll(selector);return 1==selector.length?selector[0]:selector},self.getAll=function(selector){return document.querySelectorAll(selector)},self.getById=function(id){return document.getElementById(id)},self.getFile=function(input,fn){var reader,result=null;return input.files&&input.files[0]&&((result={}).name=input.files[0].name,result.type=input.files[0].type,result.size=input.files[0].size,result.inputName=input.name,result.data=null,(reader=new FileReader).onload=function(e){result.data=e.target.result,void 0!==fn&&fn(result)},reader.readAsDataURL(input.files[0])),result},self.getInputsValues=function(){function fn(val,i,arr){result[val.id]=val.value}var allInputs=document.getElementsByTagName("input"),allSelects=document.getElementsByTagName("select"),result={};return allInputs.forEach(fn),allSelects.forEach(fn),result},self.validateInputs=function(){var inputs=self.get("input"),isValid=!0,msg="";return Array.prototype.forEach.call(inputs,function(value,index,arr){isValid=isValid&&value.checkValidity(),!1===value.checkValidity()&&null!==(value=value.getAttribute("title"))&&(msg+=value+"\r\n")}),isValid||dlg.showAlert(msg,"Error","Ok"),isValid},self.getSelect=function(name,data,val,text){var sel=document.createElement("select");sel.id=name,sel.name=name;return data.forEach(function(v,i,a){var opt=document.createElement("option");opt.value=v[val],opt.innerHTML=v[text],sel.appendChild(opt)}),sel},self.populateSelect=function(select,data,valueField,textField,value){null==value&&(value=data[0][valueField]);data.forEach(function(item,key,arr){var option=self.create("option");option.value=item[valueField],option.innerHTML=item[textField],select.appendChild(option)}),select.value=value},self.create=function(nodeName){nodeName=document.createElement(nodeName);return"undefined"!=typeof rs&&null!=rs.config&&void 0!==rs.config.options.useMVC&&rs.config.options.useMVC&&self.setMVCListener(nodeName),nodeName},self.setMVCListener=function(input){function onChange(){var nodeName,val,type,bindable=this.getAttribute("data-bind");null!==bindable&&(nodeName=this.nodeName.toLowerCase(),type=this.getAttribute("type"),val=null,val="input"==nodeName&&"checkbox"==type?this.checked:this.value,rs.returnValue(bindable)!=val)&&(rs.assignValue(bindable,val),(type=document.querySelectorAll("[data-bind='"+bindable+"']")).length,Array.prototype.forEach.call(type,function(element,key,arr){"select"==(nodeName=element.nodeName.toLowerCase())?element.value=rs.returnValue(bindable):element.innerHTML=rs.returnValue(bindable)}))}switch(input.nodeName.toLowerCase()){case"input":switch(input.getAttribute("type")){case"text":case"email":case"password":input.addEventListener("keyup",onChange),input.addEventListener("blur",onChange);break;case"date":case"time":input.addEventListener("change",onChange),input.addEventListener("blur",onChange);break;case"checkbox":case"radio":input.addEventListener("change",onChange)}break;case"textarea":input.addEventListener("keyup",onChange),input.addEventListener("blur",onChange);break;case"select":input.addEventListener("change",onChange)}var bindable=input.getAttribute("data-bind");null!==input.getAttribute("data-bind-mode")&&!function(element,bindable){var propName,privateName,bindable=bindable.split(".");1<bindable.length&&(propName=bindable[bindable.length-1],bindable.pop(),bindable=bindable.join("."),rs.evalUndefined(bindable)&&rs.assignValue(bindable,"{}"),privateName="_"+propName,rs.assignValue(bindable+"."+privateName,null),rs.defineSetter(bindable,propName,function(value){this[privateName]=value,"img"==element.nodeName.toLowerCase()?element.src=value:element!=document.activeElement&&(element.value=value)}),rs.defineGetter(bindable,propName,function(){return this[privateName]}))}(input,bindable),rs.assignValue(bindable,null)},self.bindData=function(){var self=this,inputs=document.querySelectorAll("input, textarea, select, img"),inputs=(Array.prototype.forEach.call(inputs,function(input,key,arr){self.setMVCListener(input)}),document.querySelectorAll("select[data-source]")),inputs=(Array.prototype.forEach.call(inputs,function(select,key,arr){var valueField=select.getAttribute("data-value-field"),textField=select.getAttribute("data-display-field"),dataSource=select.getAttribute("data-source"),dataBind=select.getAttribute("data-bind"),dataSource=rs.returnValue(dataSource),dataBind=rs.returnValue(dataBind);self.populateSelect(select,dataSource,valueField,textField,dataBind)}),document.querySelectorAll("[data-bind],[data-source]"));inputs.length;Array.prototype.forEach.call(inputs,function(element,key,arr){var columns,column,val,data,nodeName=element.nodeName.toLowerCase(),bindable=element.getAttribute("data-bind"),dataRepeater=element.getAttribute("data-repeater");"select"==nodeName||"input"==nodeName||"textarea"==nodeName?rs.evalUndefined(bindable)||null!==(val=rs.returnValue(bindable))&&(element.value=val):"img"==nodeName?element.src=rs.returnValue(bindable):"table"==nodeName?(bindable=element.getAttribute("data-source"),rs.evalUndefined(bindable)||(val=element.querySelectorAll("tr > th"),nodeName={},columns=[],column={},null!==element.getAttribute("class")&&(nodeName.class=element.getAttribute("class")),val.forEach(function(th,i,ths){column={};var type=th.getAttribute("data-field-type");switch(column.type=type){case"text":case"textbox":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),columns.push(column);break;case"select":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),column.source=th.getAttribute("data-source"),column.valueField=th.getAttribute("data-value-field"),column.displayField=th.getAttribute("data-display-field"),columns.push(column);break;case"hyperlink":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),column.urlFormatFields=th.getAttribute("data-url-fields"),column.text=th.getAttribute("data-text"),column.urlFormat=th.getAttribute("data-url-format"),column.onclickFormatFields=th.getAttribute("data-onclick-fields"),column.onclickFormat=th.getAttribute("data-onclick-format"),null!==column.onclickFormatFields&&(column.onclickFormatFields=column.onclickFormatFields.split(",")),null!==column.urlFormatFields&&(column.urlFormatFields=column.urlFormatFields.split(",")),columns.push(column)}}),element.clear(),data=rs.returnValue(bindable),nodeName.columns=columns,val=self.getTableFromData(data,nodeName),self.replaceTable(element,val))):"true"==dataRepeater?null===(data=rs.returnValue(element.getAttribute("data-source")))?console.error("DataRepeater.data is null"):(nodeName=(new View).populateElement(element.firstElementChild,data),element.clear(),nodeName.constructor.toString().contains("Array")?nodeName.forEach(function(item){element.append(item)}):element.append(nodeName)):element.innerHTML=rs.returnValue(bindable)})},self.replaceTable=function(table,newTable){table.parentNode.replaceChild(newTable,table)},self.bind=function(variableName){var bindedElements=document.querySelectorAll("[data-bind]");bindedElements.length;Array.prototype.forEach.call(bindedElements,function(element,key,arr){var nodeName=element.nodeName.toLowerCase(),bindable=element.getAttribute("data-bind");bindable!=variableName||rs.evalUndefined(bindable)||("select"==nodeName||"input"==nodeName||"textarea"==nodeName?element.value=rs.returnValue(bindable):element.innerHTML=rs.returnValue(bindable))})},self.addModel=function(name,data){function fn(name){console.log(name+" has changed")}(data="RSObject"!=data.constructor?new RSObject(data):data).forEach(function(value,key,obj){watcher.add(name+"."+key,fn)}),window[name]=data},self.getTableFromData=function(data,options){var table,keys,th,firstRow,fnEachRow,tr,_forEachCell=function(fn){for(var arr=this.cells,i=0,i=0;i<arr.length;i++)fn(arr[i],i,arr)};if(void 0!==data)return 0==data.length?dom.create("table"):((table=self.create("table")).forEachRow=function(fn){for(var arr=this.rows,i=0,i=0;i<arr.length;i++)fn(arr[i],i,arr)},table.checkedRows=function(){var rows=[];return this.forEachRow(function(row,index,arr){row.forEachCell(function(cell,cellIndex,cellArray){cell.childNodes.forEach(function(node,nodeIndex,nodeArray){"checkbox"==node.type&&node.checked&&rows.push(row)})})}),rows},table.sort=function(property,ascDesc){},void 0!==options&&(void 0!==options.class&&table.addClass(options.class),void 0!==options.id)&&(table.id=options.id),firstRow=data[0],keys=Object.keys(firstRow),th=null,firstRow=function(item,index,array){(th=self.create("th")).setAttribute("data-sort","asc"),th.style.cursor="pointer";var text=item+arrowUp;void 0!==item.name&&(text=item.name+arrowUp),void 0!==item.header&&(text=item.header+arrowUp),th.addText(text);th.addEventListener("click",function(){var sort=this.getAttribute("data-sort"),arrow="",sortColumn=item;for(void 0!==item.name&&(sortColumn=item.name),"asc"==sort?(sort="desc",arrow=arrowDown,data.sortDesc(sortColumn)):(sort="asc",arrow=arrowUp,data.sortAsc(sortColumn)),this.setAttribute("data-sort",sort),sortColumn+=arrow,void 0!==item.header&&(sortColumn=item.header+arrow),this.innerText=sortColumn,table.rows.length;1<table.rows.length;)table.deleteRow(1);data.forEach(fnEachRow)}),tr.appendChild(th)},fnEachRow=function(obj,i,arr){function fnEach(item,index,array){var td=self.create("td");td.addText(obj[item]),tr.appendChild(td)}(tr=self.create("tr")).forEachCell=_forEachCell,tr.data=obj,void 0!==options&&void 0!==options.onclick&&tr.addEventListener("click",function(){options.onclick(obj)}),void 0!==options&&void 0!==options.columns?options.columns.forEach(function(item,index,array){var row=obj,td=self.create("td");switch(item.type){case"checkbox":var checkbox=self.create("input");checkbox.type="checkbox",checkbox.id=item.name+"_"+i,checkbox.value=row[item.name],td.appendChild(checkbox);break;case"text":void 0!==item.transform&&"function"==typeof item.transform?td.addText(item.transform(row[item.name])):void 0!==options.isNull?null===row[item.name]&&td.addText(options.isNull):td.addText(row[item.name]);break;case"textbox":checkbox=self.create("input");checkbox.type="text",checkbox.value=row[item.name],td.appendChild(checkbox);break;case"select":break;case"hyperlink":var checkbox=self.create("a"),dataTextFormat=item.dataTextFormat,dataTextFormatFields=item.dataTextFormatFields,linkText=item.text,urlFormat=(void 0===item.text&&null!=dataTextFormat&&(null!=dataTextFormatFields&&dataTextFormatFields.forEach(function(fieldName,index,fields){dataTextFormat=dataTextFormat.replace("@"+fieldName,row[fieldName])}),linkText=dataTextFormat),checkbox.appendChild(document.createTextNode(linkText)),item.urlFormat),dataTextFormatFields=item.urlFormatFields,linkText="#",onclickFormat=(null!=urlFormat&&(null!=dataTextFormatFields&&dataTextFormatFields.forEach(function(fieldName,index,fields){urlFormat=urlFormat.replace("@"+fieldName,row[fieldName])}),linkText=urlFormat),checkbox.href=linkText,item.onclickFormat),onclickFormatFields=item.onclickFormatFields,onclick="";null!=onclickFormat&&(null!=onclickFormatFields&&onclickFormatFields.forEach(function(fieldName,index,fields){onclickFormat=onclickFormat.replace("@"+fieldName,row[fieldName])}),onclick=onclickFormat),checkbox.setAttribute("onclick",onclick),td.appendChild(checkbox);break;case"hidden":onclickFormatFields=self.create("input");onclickFormatFields.type="hidden",onclickFormatFields.value=row[item.name],td.appendChild(onclickFormatFields);break;case"textarea":onclick=self.create("textarea");onclick.value=row[item.name],td.appendChild(onclick);break;case"image":checkbox=self.create("img"),urlFormat=item.urlFormat,dataTextFormatFields=item.urlFormatFields;linkText="#",null!==urlFormat&&(linkText=(null!==dataTextFormatFields&&dataTextFormatFields.forEach(function(fieldName,index,fields){urlFormat=urlFormat.replace("@"+fieldName,row[fieldName])}),urlFormat)),checkbox.src=linkText,checkbox.style.height=item.height,checkbox.style.width=item.width,td.appendChild(checkbox)}tr.appendChild(td)}):keys.forEach(fnEach),void 0!==options&&void 0!==options.backgroundColorField&&(tr.style.backgroundColor=obj[options.backgroundColorField]),table.appendChild(tr)},(tr=self.create("tr")).setAttribute("data-rowheader",!0),tr.forEachCell=_forEachCell,tr.data=keys,(void 0!==options&&void 0!==options.columns?options.columns:keys).forEach(firstRow),table.appendChild(tr),data.forEach(fnEachRow),table);console.error("Table data is undefined"),dlg.showAlert("Los datos no estan definidos","Error","Ok")},self.setDataTable=function(id,data,options){id=dom.getById(id),null==id&&console.error(id+" do not exists"),data=self.getTableFromData(data,options);return id.clear(),data.addClass("table table-hover"),id.appendChild(data),data},self.DataTable=function(containerId,data,options){return self.setDataTable(containerId,data,options)}},window.dom=new RS.Dom,RS.Cookies=function(){},RS.Cookies.get=function(name){var cookies,result,isFound,itemResult;return""===document.cookie?null:(cookies=document.cookie.split("; "),isFound=!(result=[]),itemResult=null,cookies.forEach(function(value,index,array){var value=value.split("="),item={};item.name=value[0],item.value=value[1],void 0!==name?name==item.name&&(itemResult=item,isFound=!0):result.push(item)}),isFound?itemResult:void 0!==name?null:result)},RS.Cookies.set=function(name,value,days){days=days||1/24;var date=new Date,days=(date.setTime(date.getTime()+24*days*60*60*1e3),"expires="+date.toUTCString());document.cookie=name+"="+value+"; expires="+days},RS.Cookies.delete=function(name){var _cookies=RS.Cookies.get(name);if(null===_cookies)return null;function fnDelete(name){var expiresAt="Thu, 01 Jan 1970 00:00:01 GMT",cookie=name+"=0; expires="+expiresAt;document.cookie=cookie,cookie=name+"=0; path=/;domain="+window.location.host+"; expires="+expiresAt,document.cookie=cookie}if(void 0!==_cookies.length){if(!(0<_cookies.length))return null;_cookies.forEach(function(item,index,collection){fnDelete(item.name)})}else fnDelete(name)},RS.GeoPosition=function(){new Dialog,new RS.Local;this.Lat=0,this.Lng=0,this.LatLng=null,this.Geocode=[],this.StreetNumber="",this.Route="",this.SubLocality="",this.City="",this.State="",this.Country="",this.PostalCode="",this.Address=""},RS.Geo=function(){var fn=null;this.onError=function(error){dlg.showAlert("Hubo problemas obteniendo la posicion")},this.onSuccessGetPosition=function(position){local.remove("currentGeoPosition");var geoPos=new RS.GeoPosition;geoPos.Lat=parseFloat(position.coords.latitude),geoPos.Lng=parseFloat(position.coords.longitude),geoPos.LatLng=new google.maps.LatLng(geoPos.Lat,geoPos.Lng),this.coder=new google.maps.Geocoder,this.coder.geocode({latLng:geoPos.LatLng},function(results,status){if(status==google.maps.GeocoderStatus.OK)if(results[0]){for(var arrAddress=results[0].address_components,i=0,i=0;i<arrAddress.length;i++)switch(arrAddress[i].types[0]){case"street_number":geoPos.StreetNumber=arrAddress[i].long_name;break;case"route":geoPos.Route=arrAddress[i].long_name;break;case"sublocality_level_1":geoPos.SubLocality=arrAddress[i].long_name;break;case"locality":geoPos.City=arrAddress[i].long_name;break;case"administrative_area_level_1":geoPos.State=arrAddress[i].long_name;break;case"country":geoPos.Country=arrAddress[i].long_name;break;case"postal_code":geoPos.PostalCode=arrAddress[i].long_name}geoPos.Address=geoPos.Route+", "+geoPos.StreetNumber+", "+geoPos.SubLocality+", "+geoPos.City+", "+geoPos.State+", "+geoPos.Country,local.set("currentGeoPosition",JSON.stringify(geoPos)),fn(geoPos)}else dlg.showAlert("No results found","Error","Ok");else dlg.showAlert("Geocoder failed due to: "+status,"Error","Ok")})},this.getPositionAddress=function(callBack){fn=callBack,navigator.geolocation.getCurrentPosition(this.onSuccessGetPosition,this.onError)}};