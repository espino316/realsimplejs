function CookieHelper(){var self=this;self.set=function(name,value,days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3);var cookie=name+"="+value+"; expires="+("expires="+date.toUTCString());document.cookie=cookie},self.delete=function(name){var _cookies=self.get(name);if(null===_cookies)return null;var fnDelete=function(name){var expiresAt="Thu, 01 Jan 1970 00:00:01 GMT",cookie=name+"=0; expires="+expiresAt;document.cookie=cookie,cookie=name+"=0; path=/;domain="+window.location.host+"; expires="+expiresAt,document.cookie=cookie};if(void 0!==_cookies.length){if(!(_cookies.length>0))return null;_cookies.forEach(function(item,index,collection){fnDelete(item.name)})}else fnDelete(name)},self.get=function(name){if(""===document.cookie)return null;var result=[],isFound=!1,itemResult=null;return document.cookie.split("; ").forEach(function(value,index,array){var keyValue=value.split("="),item={};if(item.name=keyValue[0],item.value=keyValue[1],void 0!==name){if(name==item.name)return itemResult=item,void(isFound=!0)}else result.push(item)}),isFound?itemResult:void 0!==name?null:result}}function CssRule(ruleName){this.ruleName=ruleName,this.properties={}}function CssStyle(){}function CssAnimation(name){this.name=name,this.from=new CssRule("from"),this.to=new CssRule("to")}function DateHelper(){var self=this;self.timestamp=function(){return Math.floor(Date.now()/1e3)},self.getDateParts=function(date){var dateObj=new Date;void 0!==date&&(dateObj=new Date(date));var month=dateObj.getUTCMonth()+1,day=dateObj.getUTCDate(),year=dateObj.getUTCFullYear(),hour=dateObj.getUTCHours(),minutes=dateObj.getUTCMinutes(),seconds=dateObj.getUTCSeconds();month="00"+month,month=String(month).right(2),day="00"+day,day=String(day).right(2),hour="00"+hour,minutes="00"+minutes,seconds="00"+seconds;var newTime=(hour=String(hour).right(2))+":"+(minutes=String(minutes).right(2))+":"+(seconds=String(seconds).right(2)),newDate=year+"/"+month+"/"+day,dateParts={};return dateParts.year=year,dateParts.month=month,dateParts.day=day,dateParts.hour=hour,dateParts.date=newDate,dateParts.minutes=minutes,dateParts.seconds=seconds,dateParts.time=newTime,dateParts},self.diff=function(date1,date2){var diff=date2-date1,seconds=parseFloat((diff/1e3).toFixed(2)),minutes=parseFloat((seconds/60).toFixed(2)),hours=parseFloat((minutes/60).toFixed(2)),days=parseFloat((hours/24).toFixed(2)),months=parseFloat((days/30.4167).toFixed(2));return{second:seconds,minute:minutes,hour:hours,day:days,month:months,year:parseFloat((months/12).toFixed(2))}}}function Dialog(){this.showAlert=function(msg,title,buttonText){void 0===navigator.notification?alert(msg):navigator.notification.alert(msg,null,title,buttonText)},this.showConfirm=function(msg,onConfirm){null===navigator.notification?onConfirm(confirm(msg)?1:2):navigator.notification.confirm(msg,onConfirm,"Confirmar",["Si","No"])}}function RS(){var self=this;this.config=null;var locationHashBusy=!1,storedHash=window.location.hash;this.assignValue=function(bindable,value){if(null!==bindable&&null!==value){"string"==typeof value&&"{}"!=value&&"null"!=value&&(value="'"+value+"'");var parts=bindable.split("."),code="";if(parts.length>1){code="window";parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=" = "+value+";"}else code=bindable+" = "+value+";";new Function(code)()}},this.returnValue=function(bindable){if(null===bindable)return null;var self=this,parts=bindable.split(".");if(parts.length>0){if(self.evalUndefined(parts[0]))return null;if(self.evalUndefined(bindable))return null;var code="return "+bindable+";";return new Function(code)()}return self.evalUndefined(bindable)?null:void 0},this.evalUndefined=function(bindable){var code="return ( typeof "+bindable+" == 'undefined' );";return new Function(code)()},this.defineGetter=function(obj,propName,fnGet){var parts=obj.split("."),code="";if(parts.length>1){code="window";parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=".__defineGetter__( propName, fnGet );"}else code+="window['"+obj+"'].__defineGetter__( propName, fnGet );";new Function("propName","fnGet",code)(propName,fnGet)},this.defineSetter=function(obj,propName,fnSet){var parts=obj.split("."),code="";if(parts.length>1){code="window";parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=".__defineSetter__( propName, fnSet );"}else code+="window['"+obj+"'].__defineSetter__( propName, fnSet );";new Function("propName","fnSet",code)(propName,fnSet)},self.forEach=function(obj,fn){switch(typeof obj){case"object":if("number"==typeof obj.length){var i,arr=[];for(i=0;i<obj.length;i++)arr.push(obj[i]);arr.forEach(fn)}else(obj=new RSObject(obj)).forEach(fn);break;case"array":obj.forEach(fn);break;default:return null}},self.onReady=function(fn){document.addEventListener("DOMContentLoaded",function(event){fn()})},self.removeHash=function(){window.location.hash=""};var manageRoutes=function(locationHash){if("#"!=locationHash&&""!==locationHash){if(locationHashBusy=!0,"undefined"!==self.config.routes&&null!==self.config.routes){locationHash=String(locationHash),locationHash=locationHash.replace("#","");var regParam=new RegExp(":[a-zA-Z0-9]+","gi"),params=null,urlFormat=null,url=null,newUrl=null,fnEach=function(item,key,collection){var tmp=key;if(null!==(params=key.match(regParam))){if(params.forEach(function(str,idx,collection){key=key.replace(str,"[a-zA-Z0-9]+")}),null!==new RegExp(key,"i").exec(locationHash))return urlFormat=tmp,url=locationHash,void(newUrl=item)}else if(key==locationHash)return urlFormat=key,url=locationHash,void(newUrl=item)};if(new RSObject(self.config.routes).forEach(fnEach),null!==urlFormat){var segmentsUrlFormat=urlFormat.split("/"),segmentsUrl=url.split("/"),map={},fnEach=function(item,index,collection){map[item]=segmentsUrl[index]};segmentsUrlFormat.forEach(fnEach),fnEach=function(item,index,collection){newUrl=newUrl.replaceAll(item,map[item])},null!==(params=urlFormat.match(regParam))&&params.forEach(fnEach)}else console.warn(locationHash+" no route found."),newUrl=locationHash;var args=newUrl.split("/");if(args.length>=2){var controller=args[0],action=args[1];return args.splice(0,2),void 0===window[controller]?(console.error("Controlador no definido ["+controller+"]"),void(locationHashBusy=!1)):void 0===window[controller][action]?(console.error("Funcion no definida ["+controller+"."+action+"]"),void(locationHashBusy=!1)):(window[controller][action].apply(this,args),void(locationHashBusy=!1))}}locationHashBusy=!1}},hashChanged=function(locationHash){!1===locationHashBusy&&manageRoutes(locationHash)},hashChangedTick=function(){window.location.hash!=storedHash&&(storedHash=window.location.hash,hashChanged(storedHash))},setOnHashChange=function(){window.setInterval(hashChangedTick,300)};this.readConfig=function(configUrl){if(void 0===http)var http=new Http;void 0!==configUrl?http.get(configUrl,null,function(res){var response=res.data;if("object"==typeof response)self.config=response;else try{var jsonResponse=JSON.parse(response);response=jsonResponse,self.config=jsonResponse}catch(ex){return console.error("Config is not json or is unavailable"),void console.error(response)}void 0!==self.config&&(void 0!==self.config.options.useRouting&&self.config.options.useRouting&&setOnHashChange(),void 0!==self.config.options.useMVC&&self.config.options.useMVC&&dom.bindData())},function(statusText){console.error(statusText),alert(statusText)}):console.error("Configuration file undefined")}}function RSObject(obj){null===obj&&(obj={});var self=this;void 0!==obj&&Object.keys(obj).forEach(function(elem,index,arr){self[elem]=obj[elem]}),self.clone=function(from,to){Object.keys(from).forEach(function(elem,index,arr){"object"==typeof from[elem]?(to[elem]={},self.clone(from[elem],to[elem])):to[elem]=from[elem]})},self.copy=function(to){Object.keys(self).forEach(function(elem,index,arr){to[elem]=self[elem]})},self.clear=function(){self.forEach(function(value,key,obj){self[key]=null})}}function Dom(){var self=this,arrowUp=" "+"&#8679;".unescapeHTML(),arrowDown=" "+"&#8681;".unescapeHTML(),getInput=function(name,value){var input=dom.create("input");return input.setAttribute("name",name),input.setAttribute("value",value),input};self.submitForm=function(url,data){var form=dom.create("form");Object.keys(data).forEach(function(item,index,collection){var input=getInput(item,data[item]);form.appendChild(input)}),form.setAttribute("method","post"),form.setAttribute("action",url),document.body.appendChild(form),form.submit(),document.body.removeChild(form)},self.onEnter=function(element,callback){element.onkeyup=function(){13==event.keyCode&&callback()}},self.get=function(selector){var items=document.querySelectorAll(selector);return 1==items.length?items[0]:items},self.getAll=function(selector){return document.querySelectorAll(selector)},self.getById=function(id){return document.getElementById(id)},self.getFile=function(input,fn){var result=null;if(input.files&&input.files[0]){(result={}).name=input.files[0].name,result.type=input.files[0].type,result.size=input.files[0].size,result.inputName=input.name,result.data=null;var reader=new FileReader;reader.onload=function(e){result.data=e.target.result,void 0!==fn&&fn(result)},reader.readAsDataURL(input.files[0])}return result},self.getInputsValues=function(){var allInputs=document.getElementsByTagName("input"),allSelects=document.getElementsByTagName("select"),result={},fn=function(val,i,arr){result[val.id]=val.value};return allInputs.forEach(fn),allSelects.forEach(fn),result},self.validateInputs=function(){var inputs=self.get("input"),isValid=!0,msg="";return Array.prototype.forEach.call(inputs,function(value,index,arr){if(isValid=isValid&&value.checkValidity(),!1===value.checkValidity()){var title=value.getAttribute("title");null!==title&&(msg+=title+"\r\n")}}),isValid||dlg.showAlert(msg,"Error","Ok"),isValid},self.getSelect=function(name,data,val,text){var sel=document.createElement("select");sel.id=name,sel.name=name;return data.forEach(function(v,i,a){var opt=document.createElement("option");opt.value=v[val],opt.innerHTML=v[text],sel.appendChild(opt)}),sel},self.populateSelect=function(select,data,valueField,textField,value){void 0!==value&&null!==value||(value=data[0][valueField]);data.forEach(function(item,key,arr){var option=self.create("option");option.value=item[valueField],option.innerHTML=item[textField],select.appendChild(option)}),select.value=value},self.create=function(nodeName){var element=document.createElement(nodeName);return"undefined"!=typeof rs&&void 0!==rs.config&&null!==rs.config&&void 0!==rs.config.options.useMVC&&rs.config.options.useMVC&&self.setMVCListener(element),element},self.setMVCListener=function(input){var onChange=function(){var self=this,bindable=self.getAttribute("data-bind");if(null!==bindable){var nodeName=self.nodeName.toLowerCase(),type=self.getAttribute("type"),val=null;if(val="input"==nodeName&&"checkbox"==type?self.checked:self.value,rs.returnValue(bindable)!=val){rs.assignValue(bindable,val);var bindedElements=document.querySelectorAll("[data-bind='"+bindable+"']");bindedElements.length;Array.prototype.forEach.call(bindedElements,function(element,key,arr){"select"==(nodeName=element.nodeName.toLowerCase())?element.value=rs.returnValue(bindable):element.innerHTML=rs.returnValue(bindable)})}}};switch(input.nodeName.toLowerCase()){case"input":switch(input.getAttribute("type")){case"text":case"email":case"password":input.addEventListener("keyup",onChange),input.addEventListener("blur",onChange);break;case"date":case"time":input.addEventListener("change",onChange),input.addEventListener("blur",onChange);break;case"checkbox":case"radio":input.addEventListener("change",onChange)}break;case"textarea":input.addEventListener("keyup",onChange),input.addEventListener("blur",onChange);break;case"select":input.addEventListener("change",onChange)}var bindable=input.getAttribute("data-bind");null!==input.getAttribute("data-bind-mode")&&function(element,bindable){var parts=bindable.split(".");if(parts.length>1){var propName=parts[parts.length-1];parts.pop();var obj=parts.join(".");rs.evalUndefined(obj)&&rs.assignValue(obj,"{}");var privateName="_"+propName;rs.assignValue(obj+"."+privateName,null),rs.defineSetter(obj,propName,function(value){this[privateName]=value,"img"==element.nodeName.toLowerCase()?element.src=value:element!=document.activeElement&&(element.value=value)}),rs.defineGetter(obj,propName,function(){return this[privateName]})}}(input,bindable),rs.assignValue(bindable,null)},self.bindData=function(){var self=this,inputs=document.querySelectorAll("input, textarea, select, img");Array.prototype.forEach.call(inputs,function(input,key,arr){self.setMVCListener(input)});var selectElements=document.querySelectorAll("select[data-source]");Array.prototype.forEach.call(selectElements,function(select,key,arr){var valueField=select.getAttribute("data-value-field"),textField=select.getAttribute("data-display-field"),dataSource=select.getAttribute("data-source"),dataBind=select.getAttribute("data-bind");dataSource=rs.returnValue(dataSource);var selectValue=rs.returnValue(dataBind);self.populateSelect(select,dataSource,valueField,textField,selectValue)});var bindedElements=document.querySelectorAll("[data-bind],[data-source]");bindedElements.length;Array.prototype.forEach.call(bindedElements,function(element,key,arr){var nodeName=element.nodeName.toLowerCase(),bindable=element.getAttribute("data-bind"),dataRepeater=element.getAttribute("data-repeater");if("select"==nodeName||"input"==nodeName||"textarea"==nodeName){if(!rs.evalUndefined(bindable)){var val=rs.returnValue(bindable);null!==val&&(element.value=val)}}else if("img"==nodeName)element.src=rs.returnValue(bindable);else if("table"==nodeName){if(bindable=element.getAttribute("data-source"),!rs.evalUndefined(bindable)){var ths=element.querySelectorAll("tr > th"),options={},columns=[],column={};null!==element.getAttribute("class")&&(options.class=element.getAttribute("class")),ths.forEach(function(th,i,ths){column={};var type=th.getAttribute("data-field-type");switch(column.type=type,type){case"text":case"textbox":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),columns.push(column);break;case"select":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),column.source=th.getAttribute("data-source"),column.valueField=th.getAttribute("data-value-field"),column.displayField=th.getAttribute("data-display-field"),columns.push(column);break;case"hyperlink":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),column.urlFormatFields=th.getAttribute("data-url-fields"),column.text=th.getAttribute("data-text"),column.urlFormat=th.getAttribute("data-url-format"),column.onclickFormatFields=th.getAttribute("data-onclick-fields"),column.onclickFormat=th.getAttribute("data-onclick-format"),null!==column.onclickFormatFields&&(column.onclickFormatFields=column.onclickFormatFields.split(",")),null!==column.urlFormatFields&&(column.urlFormatFields=column.urlFormatFields.split(",")),columns.push(column)}}),element.clear();var data=rs.returnValue(bindable);options.columns=columns;var newTable=self.getTableFromData(data,options);self.replaceTable(element,newTable)}}else if("true"==dataRepeater){if(null===(data=rs.returnValue(element.getAttribute("data-source"))))return void console.error("DataRepeater.data is null");var temp=(new View).populateElement(element.firstElementChild,data);element.clear(),temp.constructor.toString().contains("Array")?temp.forEach(function(item){element.append(item)}):element.append(temp)}else element.innerHTML=rs.returnValue(bindable)})},self.replaceTable=function(table,newTable){table.parentNode.replaceChild(newTable,table)},self.bind=function(variableName){var bindedElements=document.querySelectorAll("[data-bind]");bindedElements.length;Array.prototype.forEach.call(bindedElements,function(element,key,arr){var nodeName=element.nodeName.toLowerCase(),bindable=element.getAttribute("data-bind");bindable==variableName&&(rs.evalUndefined(bindable)||("select"==nodeName||"input"==nodeName||"textarea"==nodeName?element.value=rs.returnValue(bindable):element.innerHTML=rs.returnValue(bindable)))})},self.addModel=function(name,data){var fn=function(name){console.log(name+" has changed")};"RSObject"!=data.constructor&&(data=new RSObject(data));data.forEach(function(value,key,obj){watcher.add(name+"."+key,fn)}),window[name]=data},self.getTableFromData=function(data,options){var _forEachCell=function(fn){var arr=this.cells,i=0;for(i=0;i<arr.length;i++)fn(arr[i],i,arr)};if(void 0===data)return console.error("Table data is undefined"),void dlg.showAlert("Los datos no estan definidos","Error","Ok");if(0==data.length)return dom.create("table");var table=self.create("table");table.forEachRow=function(fn){var arr=this.rows,i=0;for(i=0;i<arr.length;i++)fn(arr[i],i,arr)},table.checkedRows=function(){var rows=[];return this.forEachRow(function(row,index,arr){row.forEachCell(function(cell,cellIndex,cellArray){cell.childNodes.forEach(function(node,nodeIndex,nodeArray){"checkbox"==node.type&&node.checked&&rows.push(row)})})}),rows},table.sort=function(property,ascDesc){void 0===ascDesc&&(ascDesc="asc")},void 0!==options&&(void 0!==options.class&&table.addClass(options.class),void 0!==options.id&&(table.id=options.id));var firstRow=data[0],keys=Object.keys(firstRow),th=null,clearRows=function(){for(table.rows.length;table.rows.length>1;)table.deleteRow(1)},fnEachColumn=function(item,index,array){(th=self.create("th")).setAttribute("data-sort","asc"),th.style.cursor="pointer";var text=item+arrowUp;void 0!==item.name&&(text=item.name+arrowUp),void 0!==item.header&&(text=item.header+arrowUp),th.addText(text);th.addEventListener("click",function(){var self=this,sort=self.getAttribute("data-sort"),arrow="",sortColumn=item;void 0!==item.name&&(sortColumn=item.name),"asc"==sort?(sort="desc",arrow=arrowDown,data.sortDesc(sortColumn)):(sort="asc",arrow=arrowUp,data.sortAsc(sortColumn)),self.setAttribute("data-sort",sort),sortColumn+=arrow,void 0!==item.header&&(sortColumn=item.header+arrow),self.innerText=sortColumn,clearRows(),data.forEach(fnEachRow)}),tr.appendChild(th)},fnEachRow=function(obj,i,arr){var fnEach=function(item,index,array){var td=self.create("td");td.addText(obj[item]),tr.appendChild(td)};if(tr=self.create("tr"),tr.forEachCell=_forEachCell,tr.data=obj,void 0!==options&&void 0!==options.onclick){tr.addEventListener("click",function(){options.onclick(obj)})}void 0!==options&&void 0!==options.columns?options.columns.forEach(function(item,index,array){var row=obj,td=self.create("td");switch(item.type){case"checkbox":var checkbox=self.create("input");checkbox.type="checkbox",checkbox.id=item.name+"_"+i,checkbox.value=row[item.name],td.appendChild(checkbox);break;case"text":void 0!==item.transform&&"function"==typeof item.transform?td.addText(item.transform(row[item.name])):void 0!==options.isNull?null===row[item.name]&&td.addText(options.isNull):td.addText(row[item.name]);break;case"textbox":var textbox=self.create("input");textbox.type="text",textbox.value=row[item.name],td.appendChild(textbox);break;case"select":break;case"hyperlink":var hyperlink=self.create("a"),dataTextFormat=item.dataTextFormat,dataTextFormatFields=item.dataTextFormatFields,linkText=item.text;void 0===item.text&&null!==dataTextFormat&&void 0!==dataTextFormat&&(null!==dataTextFormatFields&&void 0!==dataTextFormatFields?(fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;dataTextFormat=dataTextFormat.replace(toFind,row[fieldName])},dataTextFormatFields.forEach(fnEach),linkText=dataTextFormat):linkText=dataTextFormat),hyperlink.appendChild(document.createTextNode(linkText));var urlFormat=item.urlFormat,urlFormatFields=item.urlFormatFields,url="#";null!==urlFormat&&void 0!==urlFormat&&(null!==urlFormatFields&&void 0!==urlFormatFields?(fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;urlFormat=urlFormat.replace(toFind,row[fieldName])},urlFormatFields.forEach(fnEach),url=urlFormat):url=urlFormat),hyperlink.href=url;var onclickFormat=item.onclickFormat,onclickFormatFields=item.onclickFormatFields,onclick="";null!==onclickFormat&&void 0!==onclickFormat&&(null!==onclickFormatFields&&void 0!==onclickFormatFields?(fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;onclickFormat=onclickFormat.replace(toFind,row[fieldName])},onclickFormatFields.forEach(fnEach),onclick=onclickFormat):onclick=onclickFormat),hyperlink.setAttribute("onclick",onclick),td.appendChild(hyperlink);break;case"hidden":var hidden=self.create("input");hidden.type="hidden",hidden.value=row[item.name],td.appendChild(hidden);break;case"textarea":var textarea=self.create("textarea");textarea.value=row[item.name],td.appendChild(textarea);break;case"image":var img=self.create("img");if(urlFormat=item.urlFormat,urlFormatFields=item.urlFormatFields,url="#",null!==urlFormat)if(null!==urlFormatFields){var fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;urlFormat=urlFormat.replace(toFind,row[fieldName])};urlFormatFields.forEach(fnEach),url=urlFormat}else url=urlFormat;img.src=url,img.style.height=item.height,img.style.width=item.width,td.appendChild(img)}tr.appendChild(td)}):keys.forEach(fnEach),void 0!==options&&void 0!==options.backgroundColorField&&(tr.style.backgroundColor=obj[options.backgroundColorField]),table.appendChild(tr)},tr=self.create("tr");return tr.setAttribute("data-rowheader",!0),tr.forEachCell=_forEachCell,tr.data=keys,void 0!==options&&void 0!==options.columns?options.columns.forEach(fnEachColumn):keys.forEach(fnEachColumn),table.appendChild(tr),data.forEach(fnEachRow),table},self.setDataTable=function(id,data,options){var tableParent=dom.getById(id);null==tableParent&&console.error(tableParent+" do not exists");var table=self.getTableFromData(data,options);return tableParent.clear(),table.addClass("table table-hover"),tableParent.appendChild(table),table},self.DataTable=function(containerId,data,options){return self.setDataTable(containerId,data,options)}}function Http(){var self=this,dom=new Dom,headers=new RSObject;this.setHeader=function(key,value){headers[key]=value},this.getHeaders=function(){return headers},this.clearHeaders=function(){headers={}},this.get=function(url,data){return self.request("GET",url,data)},this.post=function(url,data){return self.request("POST",url,data)},this.put=function(url,data){return self.request("PUT",url,data)},this.delete=function(url,data){return self.request("DELETE",url,data)},this.head=function(url,data){return self.request("HEAD",url,data)},this.postMultiPart=function(form){return new RSPromise(function(resolve,reject){var xhttp=new XMLHttpRequest;xhttp.open("post",form.action,!0),xhttp.onreadystatechange=function(){if(4==xhttp.readyState)if(200==xhttp.status){var res={};res.headers={};var headers=xhttp.getAllResponseHeaders();(headers=headers.split("\n")).forEach(function(item,index,collection){if(""!==item){var parts=item.split(": ");res.headers[parts[0].trim()]=parts[1].trim()}}),res.status=xhttp.status,"application/json"==res.headers["Content-Type"]?res.data=JSON.parse(xhttp.response):res.data=xhttp.response,resolve(res)}else reject(xhttp)};var formData=new FormData(form);xhttp.send(formData)})},this.request=function(method,url,data){return new RSPromise(function(resolve,reject){var localOnError=null;localOnError=void 0===reject?function(statusText){console.error(statusText)}:reject;var xhttp=new XMLHttpRequest;xhttp.onreadystatechange=function(){if(4==xhttp.readyState)if(200==xhttp.status){var res={};res.headers={};var headers=xhttp.getAllResponseHeaders();(headers=headers.split("\n")).forEach(function(item,index,collection){if(""!==item){var parts=item.split(": ");res.headers[parts[0].trim().toLowerCase()]=parts[1].trim()}}),res.status=xhttp.status,res.headers["content-type"].contains("application/json")?res.data=JSON.parse(xhttp.response):res.data=xhttp.response,resolve(res)}else localOnError(xhttp)};var setHeaders=function(){headers.forEach(function(value,key,obj){xhttp.setRequestHeader(key,value)})},toPost=null,isBinary=!1;void 0!==data&&null!==data&&(String(data.constructor).contains("function File()")?(toPost=data,isBinary=!0):toPost=(data=new RSObject(data)).serialize()),"GET"==method?(""!==toPost&&null!==toPost&&(url=url+"?"+toPost),xhttp.open(method,url,!0),setHeaders(),xhttp.send()):(xhttp.open(method,url,!0),isBinary?(setHeaders(),xhttp.setRequestHeader("Content-type","multipart/form-data; boundary=blob"),xhttp.send(toPost)):(xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),setHeaders(),xhttp.send(toPost)))})},self.downloadFile=dom.submitForm}function Local(){this.set=function(itemKey,itemValue){"object"==typeof itemValue&&(itemValue=JSON.stringify(itemValue)),window.localStorage.setItem(itemKey,itemValue)},this.remove=function(itemKey){window.localStorage.removeItem(itemKey)};var getAll=function(){var i=0,len=localStorage.length,params={};for(i=0;i<len;++i){var itemValue=localStorage.getItem(localStorage.key(i)),output={};JSON.tryParse(itemValue,output)?params[localStorage.key(i)]=output:params[localStorage.key(i)]=itemValue}return params};this.get=function(itemKey){if(void 0===itemKey)return getAll();if(null===window.localStorage.getItem(itemKey))return console.warn("Item "+itemKey+" do not exists"),null;var output={},itemValue=window.localStorage.getItem(itemKey);return JSON.tryParse(itemValue,output)?output.data:itemValue},this.exists=function(itemKey){return null!==window.localStorage.getItem(itemKey)}}function GeoPosition(){new Dialog,new Local;this.Lat=0,this.Lng=0,this.LatLng=null,this.Geocode=[],this.StreetNumber="",this.Route="",this.SubLocality="",this.City="",this.State="",this.Country="",this.PostalCode="",this.Address=""}function Geo(){var fn=null;this.onError=function(error){dlg.showAlert("Hubo problemas obteniendo la posicion")},this.onSuccessGetPosition=function(position){local.remove("currentGeoPosition");var geoPos=new GeoPosition;geoPos.Lat=parseFloat(position.coords.latitude),geoPos.Lng=parseFloat(position.coords.longitude),geoPos.LatLng=new google.maps.LatLng(geoPos.Lat,geoPos.Lng),this.coder=new google.maps.Geocoder,this.coder.geocode({latLng:geoPos.LatLng},function(results,status){if(status==google.maps.GeocoderStatus.OK)if(results[0]){var arrAddress=results[0].address_components,i=0;for(i=0;i<arrAddress.length;i++)switch(arrAddress[i].types[0]){case"street_number":geoPos.StreetNumber=arrAddress[i].long_name;break;case"route":geoPos.Route=arrAddress[i].long_name;break;case"sublocality_level_1":geoPos.SubLocality=arrAddress[i].long_name;break;case"locality":geoPos.City=arrAddress[i].long_name;break;case"administrative_area_level_1":geoPos.State=arrAddress[i].long_name;break;case"country":geoPos.Country=arrAddress[i].long_name;break;case"postal_code":geoPos.PostalCode=arrAddress[i].long_name}geoPos.Address=geoPos.Route+", "+geoPos.StreetNumber+", "+geoPos.SubLocality+", "+geoPos.City+", "+geoPos.State+", "+geoPos.Country,local.set("currentGeoPosition",JSON.stringify(geoPos)),fn(geoPos)}else dlg.showAlert("No results found","Error","Ok");else dlg.showAlert("Geocoder failed due to: "+status,"Error","Ok")})},this.getPositionAddress=function(callBack){fn=callBack,navigator.geolocation.getCurrentPosition(this.onSuccessGetPosition,this.onError)}}function PubSub(){var self=this;self.channels={},self.subscribe=function(channel,onPublish){this.channels[channel]||(this.channels[channel]=[]),this.channels[channel].push(onPublish)},self.publish=function(channel,data){!this.channels[channel]||this.channels[channel].length<1||this.channels[channel].forEach(function(onPublish){onPublish(data||{})})}}function Restful(resourceUrl){var http=new Http,self=this,responseHandler=null,match=/:\b[a-z]+/g.exec(resourceUrl);if(void 0!==match&&match.length>0){var key=(match=match[0]).replace(":","");resourceUrl=void 0!==self[key]?resourceUrl.replace(match,self[key]):resourceUrl.replace(match,"")}var setData=function(){var data={};return Object.keys(self).forEach(function(key,index,arr){var value=self[key];"function"!=typeof value&&(data[key]=value)}),data},createCollection=function(response){var result=[];return response.forEach(function(item,index,arr){var r=new window.Restful(resourceUrl);item.forEach(function(value,key,obj){r[key]=value}),result.push(r)}),result},updateModel=function(model){model.forEach(function(value,key,obj){self[key]=value})},onGet=function(response){if("object"==typeof response)if(response instanceof Array){if(void 0!==responseHandler){var collection=createCollection(response);responseHandler(collection),responseHandler=null}}else updateModel(response);else console.error("Response is neither Array nor Object.")};this.get=function(fnResponse){void 0!==fnResponse&&(responseHandler=fnResponse),http.get(resourceUrl,null,onGet)},this.post=function(){var data=setData();http.post(resourceUrl,data,onRequest)},this.put=function(){var data=setData();http.put(resourceUrl,data,onRequest)},this.delete=function(){var data=setData();http.delete(resourceUrl,data,onRequest)},this.head=function(){var data=setData();http.head(resourceUrl,data,onRequest)}}function View(id){var self=this,dom=new Dom;self.contentId=id,self.content=dom.getById(self.contentId),self.httpR=null,self.setHttp=function(){null===this.httpR&&("undefined"!=typeof http?this.httpR=http:this.httpR=new Http)},self.setHttp(),self.setContent=function(){self.content=dom.getById(self.contentId)},self.loadUrl=function(url,data){return new RSPromise(function(resolve,reject){return self.setContent(),null===data||"undefined"==typeof date?data=new RSObject(data):data.constructor.toString().contains("Object")&&(data=new RSObject(data)),self.httpR.post(url,data).then(function(response){var template=String(response.data);template=self.populateTemplate(template,data),self.content.innerHTML=template,dom.bindData(),void 0!==resolve&&resolve()})})},self.loadTemplate=function(id,data){null===data?data=new RSObject(data):data.constructor.toString().contains("Object")&&(data=new RSObject(data));var html=dom.getById(id).innerHTML;self.loadHTML(html,data),dom.bindData()},self.loadHTML=function(html,data){self.setContent(),html=self.populateTemplate(html,data),self.content.innerHTML=html,dom.bindData()},self.populateElement=function(el,data){if(void 0!==data&&null!==data){if(void 0!==data.length){var result=[];return data.forEach(function(item,index,collection){result.push(self.populateElement(el,item))}),result}if(null!==data){data=new RSObject(data);var copyEl=el.cloneNode(!0);return copyEl.dataItem=data,copyEl.querySelectorAll("[data-bind]").forEach(function(element){var dataBind=element.getAttribute("data-bind"),nodeName=element.nodeName.toLowerCase();"div"!=nodeName&&"span"!=nodeName||(element.innerHTML=data[dataBind])}),copyEl}}},self.populateTemplate=function(template,data){if(void 0!==data&&null!==data){if(void 0!==data.length){var result="";return data.forEach(function(item,index,collection){result+=self.populateTemplate(template,item)}),result}if(null!==data){data=new RSObject(data);var jsonString=JSON.stringify(data);jsonString=jsonString.encodeUri(),template=template.replaceAll("$itemJson",jsonString);data.forEach(function(value,key,obj){var find="$"+key;template=template.replaceAll(find,value)})}}var reg=new RegExp("\\$[a-zA-Z0-9]+","gi"),variables=template.match(reg);return null!==variables&&variables.forEach(function(item,index,collection){var varName=item.replace("$","");void 0!==window[varName]&&(template=template.replaceAll(item,window[varName]))}),template}}function Modal(){var divTitle,divMessage,divButton,self=this,divModal=dom.getById("modalContainer"),divModalContent=dom.getById("modalContent");self.getContainer=function(){return divModal};var fnLoadModal=function(){null===divModal&&((divModal=dom.create("div")).id="modalContainer",divModal.addClass("modal")),null===divModalContent&&((divModalContent=dom.create("div")).id="modalContent",divModalContent.addClass("modalContent"),divModal.appendChild(divModalContent)),null===dom.getById("modalContainer")&&dom.get("body").appendChild(divModal)};rs.onReady(fnLoadModal),(self=this).trimereet="",self.showUrl=function(url,data){null===divModal&&fnLoadModal(),divModalContent.style.width="70%",divModalContent.style.height="70vh",divModalContent.style.marginTop="20vh",divModalContent.clear();var view=new View("modalContent");void 0!==data&&null!==data?view.loadUrl(url,data):view.loadUrl(url),divModal.style.display="block"},self.showTemplate=function(templateId,data){null===divModal&&fnLoadModal(),divModalContent.style.width="70%",divModalContent.style.height="70vh",divModalContent.style.marginTop="20vh",divModalContent.style.padding="1vh",divModalContent.clear();var template=dom.getById(templateId),temp="";temp=void 0!==data?(new View).populateTemplate(template.innerHTML,data):template.innerHTML,divModalContent.innerHTML=temp,divModal.style.display="block"},self.showInfo=function(message,title,buttonText){null===divModal&&fnLoadModal(),void 0===title&&(title="Info"),void 0===buttonText&&(buttonText="Ok"),divModalContent.style.width="80%",divModalContent.style.height="40%",divModalContent.style.marginTop="40%",divModalContent.style.padding="10px",divModalContent.clear(),(divTitle=dom.create("div")).style.height="25%",divTitle.style.width="100%",divTitle.style.float="left",divTitle.innerHTML=title,(divMessage=dom.create("div")).style.height="50%",divMessage.style.width="100%",divMessage.style.float="left",divMessage.innerHTML=message,(divButton=dom.create("div")).style.height="25%",divButton.style.width="50%",divButton.style.float="right",divButton.addClass("button"),divButton.addClass("go"),divButton.onclick=function(){self.hide()},divButton.innerHTML=buttonText,divModalContent.appendChild(divTitle),divModalContent.appendChild(divMessage),divModalContent.appendChild(divButton),divModal.style.display="block"},self.showWait=function(message){null===divModal&&fnLoadModal(),divModalContent.style.width="80%",divModalContent.style.height="20vh",divModalContent.style.marginTop="40vh",divModalContent.style.padding="4vh",divModalContent.clear(),void 0===message&&(message="Espere, por favor");var txt=document.createTextNode(message),img=document.createElement("img");img.src="img/preloader.gif",img.style.width="90%",img.style.marginLeft="5%",img.style.float="left",divModalContent.appendChild(txt),divModalContent.appendChild(document.createElement("br")),divModalContent.appendChild(document.createElement("br")),divModalContent.appendChild(img),divModal.style.display="block"},self.hide=function(){null===divModal&&fnLoadModal(),divModal.style.display="none",divModalContent.clear()}}function Watcher(){var self=this;this.collection=[],this.add=function(name,fn){var item={};item.name=name,item.currentValue=rs.returnValue(name),item.function=fn,this.collection.push(item)};setInterval(function(){self.collection.forEach(function(item,index,arr){var val=rs.returnValue(item.name);val!=item.currentValue&&(item.function(item.name),item.currentValue=val)})},200)}function Validations(){var self=this,validateType=function(value,type,i){if(void 0===i&&(i=-1),null!==type){if("function"!=typeof type&&"object"!=typeof type){if(typeof value!=type)throw new Exception("Different type at index position "+i," validateArgumentsTypes")}else if(value.constructor!=type)throw new Exception("Different constructor at index position "+i," validateArgumentsTypes")}else if(null!==value)throw new Exception("Argument "+i+" different type. It can be null also","validateArguentTypes")},validateArgumentsTypes=function(args,types){var i=0;for(i=0;i<args.length;i++){var type=types[i],value=args[i];if("[object Array]"!==Object.prototype.toString.call(type))validateType(value,type,i);else{var count=0,exception=null;if(type.forEach(function(item,index){try{self.validateType(value,item,i)}catch(ex){if(ex instanceof Exception)return exception=ex,void count++;console.error(ex)}}),type.length==count)throw exception}}return!0},validateArgumentsNumber=function(args,quantity){if(args.length!=quantity)throw new Exception("Must set "+quantity+" arguments",this)};self.args=function(_args,number,types){validateArgumentsNumber(_args,number),validateArgumentsTypes(_args,types)};var queue=[];self.add=function(obj,options,message){return queue.push([obj,options,message]),self},self.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},self.isFunction=function(fn){return fn&&"[object Function]"===Object.prototype.toString.call(fn)},self.rules={REQUIRED:function(obj,message){if(null===obj||void 0===obj)throw queue=[],void 0===message&&(message=String(obj)+" is required"),new Exception(message,"Validations.REQUIRED");return!0},NONEMPTY:function(obj,message){if(""==obj||null===obj||void 0===obj)throw queue=[],void 0===message&&(message=String(obj)+" is empty"),new Exception(message,"Validations.NONEMPTY");return!0},NUMERIC:function(obj,message){if(!Math.isNumeric(obj))throw queue=[],void 0===message&&(message=String(obj)+" is not numeric"),new Exception(message,"Validations.NUMERIC");return!0},INTEGER:function(obj,message){if(!Number.isInteger(obj))throw queue=[],void 0===message&&(message=String(obj)+" is not integer"),new Exception(message,"Validations.INTEGER");return!0},EMAIL:function(obj,message){if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(obj))throw queue=[],void 0===message&&(message=String(obj)+" is not EMAIL"),new Exception(message,"Validations.EMAIL");return!0}},self.validate=function(){return 0===queue.length||(queue.forEach(function(item,index){if(!self.isArray(item))throw queue=[],new Exception("Item is not an array","Validations.validate.isArray");if(3!=item.length)throw queue=[],new Exception("The rule has more or less than three arguments. Only a value, a name and a set of rules are necessary","Validations.validate");var val=item[0],message=item[2],rules=item[1];if(self.isFunction(rules)&&(rules=[rules]),!self.isArray(rules))throw new Exception("Rules is not an array","Validations.validate.Rules.isArray");rules.forEach(function(rule){rule(val,message)})}),queue=[],!0)}}function Activity(config){console.log(config);var self=this;self.containerId=config.containerId,self.url=config.url;var view=new View(self.containerId);self.hide=function(){null===view.content&&(view=new View(self.containerId)),view.content.removeClass("animateclassanimationActivityLeft"),view.content.addClass("animateclassanimationActivityRight")},self.load=function(data){console.log(view),null===view.content&&(view=new View(self.containerId)),void 0===data&&(data=null),view.loadUrl(self.url,data,function(){view.content.removeClass("animateclassanimationActivityRight"),view.content.addClass("animateclassanimationActivityLeft")})}}Date.now||(Date.now=function(){return(new Date).getTime()}),JSON.tryParse=function(str,out){try{return out.data=JSON.parse(str),!0}catch(ex){return!1}};var hiddenEscapeTextArea=document.createElement("textarea");if(String.prototype.UUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)})},String.prototype.escapeHTML=function(){var self=this;if(void 0===hiddenEscapeTextArea)var hiddenEscapeTextArea=document.createElement("textarea");return hiddenEscapeTextArea.textContent=self,hiddenEscapeTextArea.innerHTML},String.prototype.unescapeHTML=function(){var self=this;if(void 0===hiddenEscapeTextArea)var hiddenEscapeTextArea=document.createElement("textarea");return hiddenEscapeTextArea.innerHTML=self,hiddenEscapeTextArea.textContent},String.prototype.encodeUri=function(){return encodeURIComponent(this)},String.prototype.decodeUri=function(){return decodeURIComponent(this)},String.prototype.base64Encode=function(){var self=this;return self=(self=self.encodeUri()).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}),btoa(self)},String.prototype.base64Decode=function(){var self=this;try{self=atob(self)}catch(ex){return void console.error("No base 64 data")}return self=Array.prototype.map.call(self,function(item){return"%"+("00"+item.charCodeAt(0).toString(16)).slice(-2)}),self=self.join(""),self=self.decodeUri()},String.prototype.escapeRegExp=function(){return this.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},String.prototype.replaceAll=function(find,replace){return this.replace(new RegExp(find.escapeRegExp(),"g"),replace)},String.prototype.left=function(n){return n<=0?"":n>this.length?this:this.substring(0,n)},String.prototype.right=function(n){if(n<=0)return"";if(n>this.length)return this;var iLen=this.length;return this.substring(iLen,iLen-n)},String.prototype.contains=function(str){return this.indexOf(str)>-1},String.prototype.toHex=function(){var i,hex="0x";for(i=0;i<this.length;i++)hex+=""+this.charCodeAt(i).toString(16);return hex},String.prototype.fromHex=function(hex){hex=hex.toString();var i,str="";for(i=0;i<hex.length;i+=2)str+=String.fromCharCode(parseInt(hex.substr(i,2),16));return str},HTMLElement.prototype.hide=function(){this.style.display="none"},HTMLElement.prototype.show=function(){this.style.display="block"},HTMLElement.prototype.hasClass=function(className){var rgx=new RegExp("(\\s|^)"+className+"(\\s|$)");return null!==this.className.match(rgx)},HTMLElement.prototype.addClass=function(className){this.hasClass(className)||(this.className+=" "+className)},HTMLElement.prototype.removeClass=function(className){if(this.hasClass(className)){var reg=new RegExp("(\\s|^)"+className+"(\\s|$)");this.className=this.className.replace(reg," ")}},HTMLElement.prototype.addText=function(text){var t=document.createTextNode(text);this.appendChild(t)},HTMLElement.prototype.clear=function(){for(;this.firstChild;)this.removeChild(this.firstChild)},HTMLElement.prototype.animate=function(options){var element=this,style=new CssStyle,animateClass=new CssRule("animateclass"+options.name);animateClass.addProperty("-webkit-animation-name",options.name),animateClass.addProperty("-webkit-animation-duration",options.duration),animateClass.addProperty("animation-name",options.name),animateClass.addProperty("animation-duration",options.duration),animateClass.addProperty("animation-fill-mode","forwards"),animateClass.addProperty("-webkit-animation-fill-mode","forwards"),style.addClass(animateClass);var animateFrames=new CssAnimation(options.name),keys=Object.keys(options.from),i=0;for(i=0;i<keys.length;i++)animateFrames.from.addProperty(keys[i],options.from[keys[i]]);for(keys=Object.keys(options.to),i=0,i=0;i<keys.length;i++)animateFrames.to.addProperty(keys[i],options.to[keys[i]]);style.addClass(animateFrames),style.setStyle(),element.removeClass(animateClass.className),element.offsetWidth,element.addClass(animateClass.className)},Math.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},Array.prototype.getUnique=function(){for(var u={},a=[],i=0,l=this.length;i<l;++i)u.hasOwnProperty(this[i])||(a.push(this[i]),u[this[i]]=1);return a},Array.prototype.encodeUri=function(){var str=JSON.stringify(this);return encodeURIComponent(str)},Array.prototype.where=function(item,value){var result=[];return this.forEach(function(obj,index,arr){obj[item]==value&&result.push(obj)}),result},Array.prototype.andWhere=function(item,value){var result=[];return this.forEach(function(obj,index,arr){obj[item]==value&&result.push(obj)}),result},Array.prototype.first=function(){return this[0]},Array.prototype.like=function(item,value){var result=[];return this.forEach(function(obj,index,arr){String(obj[item]).contains(value)&&result.push(obj)}),result},Array.prototype.andLike=function(item,value){var result=[];return this.forEach(function(obj,index,arr){String(obj[item]).contains(value)&&result.push(obj)}),result},Array.prototype.indexOf=function(item,value){var result=-1;return this.forEach(function(elem,index,arr){elem[item]==value&&(result=index)}),result},Array.prototype.contains=function(value){var result=!1;return this.forEach(function(elem,index,self){elem==value&&(result=!0)}),result},void 0===Array.prototype.forEach){var self=this;Array.prototype.forEach=function(fn){var i,len;for(len=self.length,i=0;i<len;i++)fn(self[i],i,self)}}Array.prototype.sortAsc=function(property){var self=this;{if(0!==self.length){var row=self[0];void 0===row[property]&&console.error(property+" no part of object.",self),window.__tempFilter=property;var getValue=function(v){return Math.isNumeric(v)?1*v:v};return Math.isNumeric(row[property])?self.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter],_b=b[filter];return getValue(_a)-getValue(_b)}):self.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter],_b=b[filter];return _a.localeCompare(_b)})}console.warn("No data to sort",self,property)}},Array.prototype.sortDesc=function(property){var self=this;{if(0!==self.length){var row=self[0];void 0===row[property]&&console.error(property+" no part of object.",self),window.__tempFilter=property;var getValue=function(v){return Math.isNumeric(v)?1*v:v};return Math.isNumeric(row[property])?self.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter],_b=b[filter];return getValue(_b)-getValue(_a)}):self.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter];return b[filter].localeCompare(_a)})}console.warn("No data to sort",self,property)}},window.BreakException={},Array.prototype.each=function(fn){var self=this;try{var i,len;for(len=self.length,i=0;i<len;i++)fn(self[i],i,self)}catch(e){if(e!==BreakException)throw e}},Array.prototype.sum=function(prop){var self=this;if(0===self.length)return 0;if("object"==typeof self[0]){if(self[0].hasOwnProperty(prop)){var sum=0;return self.forEach(function(item){sum+=Number(item[prop])}),sum}console.error("Items does not have a "+prop+" property.")}else console.error("Items are not objects")},window.Exception=function(message,reference){this.message=message,this.reference=reference},CssRule.prototype.ruleName="",CssRule.prototype.addProperty=function(propertyName,propertyValue){this.properties[propertyName]=propertyValue},CssRule.prototype.toString=function(){var css="."+this.ruleName+" {\n",keys=Object.keys(this.properties),len=keys.length,i=0;for(i=0;i<len;i++)css+=keys[i]+": "+this.properties[keys[i]]+";",css+="\n";return css+="}"},CssStyle.prototype.classes=[],CssStyle.prototype.addClass=function(cssClass){this.classes.push(cssClass)},CssStyle.prototype.toString=function(){var i,len=this.classes.length,css="";for(i=0;i<len;i++)css+=this.classes[i].toString()+"\n\n";return css},CssStyle.prototype.setStyle=function(){var style=document.createElement("style");style.type="text/css",style.innerHTML=this.toString(),document.getElementsByTagName("head")[0].appendChild(style)},CssAnimation.prototype.name="",CssAnimation.prototype.from=null,CssAnimation.prototype.to=null,CssAnimation.prototype.toString=function(){var css="@keyframes "+this.name+" {\n@from\n@to\n}",cssFrom=this.from.toString(),cssTo=this.to.toString();cssFrom=cssFrom.replace(".from","from"),cssTo=cssTo.replace(".to","to"),css=(css=css.replace("@from",cssFrom)).replace("@to",cssTo);var wkcss="@-webkit-keyframes "+this.name+" {\n@from\n@to\n}";return wkcss=wkcss.replace("@from",cssFrom),wkcss=wkcss.replace("@to",cssTo),css+"\n"+wkcss},window.date=new DateHelper,Date.prototype.diff=function(date2){var self=this;return date.diff(self,date2)},window.dlg=new Dialog,RSObject.prototype.forEach=function(fn){var i,self=this,keys=Object.keys(self),len=keys.length;for(i=0;i<len;i++){var type=typeof self[keys[i]];"function"!=type&&"undefined"!=type&&fn(self[keys[i]],keys[i],self)}},RSObject.prototype.encodeUri=function(){var str=JSON.stringify(this);return encodeURIComponent(str)},RSObject.prototype.decodeUri=function(){var str=JSON.stringify(this);return decodeURIComponent(str)},RSObject.prototype.exists=function(obj){return void 0!==obj},RSObject.prototype.isNull=function(obj){return null===obj},RSObject.prototype.isSet=function(obj){var result=!1;if(obj){result=!0;var toStr=Object.prototype.toString.call(obj),len=1;"Object"==(toStr=(toStr=toStr.replace("[object ","")).replace("]",""))?len=Object.keys(obj).length:"Array"==toStr&&(len=obj.length),result=len>0}return result},RSObject.prototype.addProperty=function(obj,name,onChange){Object.defineProperty(obj,name,{_x:null,get:function(){return _x},set:function(value){_x=value,void 0!==onChange&&onChange(obj)}})},RSObject.prototype.serialize=function(){var result=[],current="",fn=function(value,key,obj){if("function"!=typeof value)if("object"==typeof value)current=key,new RSObject(value).forEach(fn),current="";else if(""!==current){var item=current+"["+key+"]="+value;result.push(item)}else result.push(key+"="+value)};return this.forEach(fn),result.join("&")},window.rs=new RS,window.rs.object=new RSObject,window.dom=new Dom,function(){function RSPromise(functionPromise){var self=this;self.promiseQueue=[],self.onFullfilled=null,self.onRejected=null,self.state=States.PENDING,self.value=null,self.then=function(onFullfilled,onRejected){var promiseToQueue=new RSPromise;return void 0!==onFullfilled&&(promiseToQueue.onFullfilled=onFullfilled),"undefined"!=typeof onReject&&(promiseToQueue.onRejected=onRejected),self.promiseQueue.push(promiseToQueue),self.processQueue(),promiseToQueue};var fulfillBackfall=function(val){return val},rejectBackfall=function(err){throw err},loopQueue=function(){for(;self.promiseQueue.length>0;){var currentPromise=self.promiseQueue.shift(),promiseHandler=fulfillBackfall;self.state==States.FULLFILED&&null!==currentPromise.onFulfilled&&(promiseHandler=currentPromise.onFullfilled),self.state==States.REJECTED&&(promiseHandler=rejectBackfall,null!==currentPromise.onRejected&&(promiseHandler=currentPromise.onRejected));var returnedValue=null;try{returnedValue=promiseHandler(self.value)}catch(ex){setState(currentPromise,States.Rejected,ex);continue}resolve(currentPromise,returnedValue)}};self.processQueue=function(){self.state!=States.PENDING&&setImmediate(loopQueue)};var resolve=function(promise,value){if(promise!==value){if(isRSPromise(value))return value.state===States.PENDING?void value.then(function(val){resolve(promise,val)},function(err){setState(promise,States.REJECTED,err)}):void setState(promise,value.state,value.value);if("object"!=typeof value&&"function"!=typeof value)setState(promise,States.FULLFILED,value);else{var thenHandler=null;try{thenHandler=value.then}catch(ex){setState(promise,States.REJECTED,ex)}if("function"==typeof thenHandler){var isCalled=!1;try{value.then.call(value,function(y){isCalled||(resolve(promise,y),isCalled=!0)},function(r){isCalled||(setState(promise,States.REJECTED,r),isCalled=!0)})}catch(ex){isCalled||setState(promise,States.REJECT,ex)}return}setState(promise,States.FULLFILED,value)}}else setState(promise,States.REJECTED,new TypeError("Promise and value are the same"))};functionPromise&&functionPromise(function(value){resolve(self,value)},function(error){setState(self,States.REJECTED,error)})}var States={PENDING:"pending",FULLFILED:"fullfiled",REJECTED:"rejected",validate:function(state){return"pending"==state||"fullfiled"==state||"rejected"==state}},isRSPromise=function(obj){return void 0!==obj&&obj.constructor===self.constructor},setImmediate=function(fn){setTimeout(fn,0)},setState=function(promise,state,val){promise.state===States.PENDING&&promise.state!==state&&States.validate(state)&&(promise.state=state,promise.value=val,promise.state===States.REJECTED&&console.error(promise.value),promise.processQueue())};window.RSPromise=RSPromise}(),window.http=new Http,window.local=new Local;var modal=new Modal,validations=new Validations,VALIDATION_RULES=validations.rules;