function RS(){var self=this;this.config=null;var locationHashBusy=!1,storedHash=window.location.hash;this.assignValue=function(bindable,value){if(null!==bindable&&null!==value){"string"==typeof value&&"{}"!=value&&"null"!=value&&(value="'"+value+"'");var parts=bindable.split("."),code="";if(1<parts.length){code="window";parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=" = "+value+";"}else code=bindable+" = "+value+";";new Function(code)()}},this.returnValue=function(bindable){if(null===bindable)return null;var parts=bindable.split(".");{if(0<parts.length)return this.evalUndefined(parts[0])?null:this.evalUndefined(bindable)?null:new Function("return "+bindable+";")();if(this.evalUndefined(bindable))return null}},this.evalUndefined=function(bindable){return new Function("return ( typeof "+bindable+" == 'undefined' );")()},this.defineGetter=function(obj,propName,fnGet){var parts=obj.split("."),code="";if(1<parts.length){code="window";parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=".__defineGetter__( propName, fnGet );"}else code+="window['"+obj+"'].__defineGetter__( propName, fnGet );";new Function("propName","fnGet",code)(propName,fnGet)},this.defineSetter=function(obj,propName,fnSet){var parts=obj.split("."),code="";if(1<parts.length){code="window";parts.forEach(function(item,index,collection){code+="['"+item+"']"}),code+=".__defineSetter__( propName, fnSet );"}else code+="window['"+obj+"'].__defineSetter__( propName, fnSet );";new Function("propName","fnSet",code)(propName,fnSet)},self.forEach=function(obj,fn){switch(typeof obj){case"object":if("number"==typeof obj.length){var i,arr=[];for(i=0;i<obj.length;i++)arr.push(obj[i]);arr.forEach(fn)}else(obj=new RSObject(obj)).forEach(fn);break;case"array":obj.forEach(fn);break;default:return null}},self.onReady=function(fn){document.addEventListener("DOMContentLoaded",function(event){fn()})},self.removeHash=function(){window.location.hash=""};function hashChanged(locationHash){!1===locationHashBusy&&function(locationHash){if("#"!=locationHash&&""!==locationHash){if(locationHashBusy=!0,"undefined"!==self.config.routes&&null!==self.config.routes){locationHash=(locationHash=String(locationHash)).replace("#","");var regParam=new RegExp(":[a-zA-Z0-9]+","gi"),params=null,urlFormat=null,url=null,newUrl=null,fnEach=function(item,key,collection){var tmp=key;if(null!==(params=key.match(regParam))){if(params.forEach(function(str,idx,collection){key=key.replace(str,"[a-zA-Z0-9]+")}),null!==new RegExp(key,"i").exec(locationHash))return urlFormat=tmp,url=locationHash,void(newUrl=item)}else if(key==locationHash)return urlFormat=key,url=locationHash,void(newUrl=item)};if(new RSObject(self.config.routes).forEach(fnEach),null!==urlFormat){var segmentsUrlFormat=urlFormat.split("/"),segmentsUrl=url.split("/"),map={};fnEach=function(item,index,collection){map[item]=segmentsUrl[index]};segmentsUrlFormat.forEach(fnEach),fnEach=function(item,index,collection){newUrl=newUrl.replaceAll(item,map[item])},null!==(params=urlFormat.match(regParam))&&params.forEach(fnEach)}else console.warn(locationHash+" no route found."),newUrl=locationHash;var args=newUrl.split("/");if(2<=args.length){var controller=args[0],action=args[1];return args.splice(0,2),void 0===window[controller]?console.error("Controlador no definido ["+controller+"]"):void 0===window[controller][action]?console.error("Funcion no definida ["+controller+"."+action+"]"):window[controller][action].apply(this,args),locationHashBusy=!1}}locationHashBusy=!1}}(locationHash)}function hashChangedTick(){window.location.hash!=storedHash&&(storedHash=window.location.hash,hashChanged(storedHash))}this.readConfig=function(configUrl){if(void 0===http)var http=new Http;void 0!==configUrl?http.get(configUrl,null,function(res){var response=res.data;if("object"==typeof response)self.config=response;else try{var jsonResponse=JSON.parse(response);response=jsonResponse,self.config=jsonResponse}catch(ex){return console.error("Config is not json or is unavailable"),void console.error(response)}void 0!==self.config&&(void 0!==self.config.options.useRouting&&self.config.options.useRouting&&window.setInterval(hashChangedTick,300),void 0!==self.config.options.useMVC&&self.config.options.useMVC&&dom.bindData())},function(statusText){console.error(statusText),alert(statusText)}):console.error("Configuration file undefined")}}RS.Object=function(obj){null===obj&&(obj={});var self=this;void 0!==obj&&Object.keys(obj).forEach(function(elem,index,arr){self[elem]=obj[elem]}),self.clone=function(from,to){Object.keys(from).forEach(function(elem,index,arr){"object"==typeof from[elem]?(to[elem]={},self.clone(from[elem],to[elem])):to[elem]=from[elem]})},self.copy=function(to){Object.keys(self).forEach(function(elem,index,arr){to[elem]=self[elem]})},self.clear=function(){self.forEach(function(value,key,obj){self[key]=null})},self.forEach=function(fn){var i,keys=Object.keys(this),len=keys.length;for(i=0;i<len;i++){var type=typeof this[keys[i]];"function"!=type&&"undefined"!=type&&fn(this[keys[i]],keys[i],this)}},self.encodeUri=function(){var str=JSON.stringify(this);return encodeURIComponent(str)},self.decodeUri=function(){var str=JSON.stringify(this);return decodeURIComponent(str)},self.exists=function(obj){return void 0!==obj},self.isNull=function(obj){return null===obj},self.isSet=function(obj){var result=!1;if(obj){result=!0;var toStr=Object.prototype.toString.call(obj),len=1;"Object"==(toStr=(toStr=toStr.replace("[object ","")).replace("]",""))?len=Object.keys(obj).length:"Array"==toStr&&(len=obj.length),result=0<len}return result},self.addProperty=function(obj,name,onChange){Object.defineProperty(obj,name,{_x:null,get:function(){return _x},set:function(value){_x=value,void 0!==onChange&&onChange(obj)}})},self.serialize=function(){var result=[],current="",fn=function(value,key,obj){if("function"!=typeof value)if("object"==typeof value)current=key,new RSObject(value).forEach(fn),current="";else if(""!==current){var item=current+"["+key+"]="+value;result.push(item)}else result.push(key+"="+value)};return this.forEach(fn),result.join("&")}},RS.String=function(){document.createElement("textarea");this.UUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)})},this.escapeHTML=function(){if(void 0===hiddenEscapeTextArea)var hiddenEscapeTextArea=document.createElement("textarea");return hiddenEscapeTextArea.textContent=this,hiddenEscapeTextArea.innerHTML},this.unescapeHTML=function(){if(void 0===hiddenEscapeTextArea)var hiddenEscapeTextArea=document.createElement("textarea");return hiddenEscapeTextArea.innerHTML=this,hiddenEscapeTextArea.textContent},this.encodeUri=function(){return encodeURIComponent(this)},this.decodeUri=function(){return decodeURIComponent(this)},this.base64Encode=function(){var self=this;return self=(self=self.encodeUri()).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}),btoa(self)},this.base64Decode=function(){var self=this;try{self=atob(self)}catch(ex){return void console.error("No base 64 data")}return self=(self=(self=Array.prototype.map.call(self,function(item){return"%"+("00"+item.charCodeAt(0).toString(16)).slice(-2)})).join("")).decodeUri()},this.escapeRegExp=function(){return this.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},this.replaceAll=function(find,replace){return this.replace(new RegExp(find.escapeRegExp(),"g"),replace)},this.left=function(n){return n<=0?"":n>this.length?this:this.substring(0,n)},this.right=function(n){if(n<=0)return"";if(n>this.length)return this;var iLen=this.length;return this.substring(iLen,iLen-n)},this.contains=function(str){return-1<this.indexOf(str)},this.toHex=function(){var i,hex="0x";for(i=0;i<this.length;i++)hex+=""+this.charCodeAt(i).toString(16);return hex},this.fromHex=function(hex){hex=hex.toString();var i,str="";for(i=0;i<hex.length;i+=2)str+=String.fromCharCode(parseInt(hex.substr(i,2),16));return str}},RS.HTMLElement=function(elem){return elem.hide=function(){elem.style.display="none"},elem.show=function(){elem.style.display="block"},elem.hasClass=function(className){var rgx=new RegExp("(\\s|^)"+className+"(\\s|$)");return null!==elem.className.match(rgx)},elem.addClass=function(className){elem.hasClass(className)||(elem.className+=" "+className)},elem.removeClass=function(className){if(elem.hasClass(className)){var reg=new RegExp("(\\s|^)"+className+"(\\s|$)");elem.className=elem.className.replace(reg," ")}},elem.addText=function(text){var t=document.createTextNode(text);elem.appendChild(t)},elem.clear=function(){for(;elem.firstChild;)elem.removeChild(elem.firstChild)},elem.animate=function(options){var element=elem,style=new RS.CssStyle,animateClass=new RS.CssRule("animateclass"+options.name);animateClass.addProperty("-webkit-animation-name",options.name),animateClass.addProperty("-webkit-animation-duration",options.duration),animateClass.addProperty("animation-name",options.name),animateClass.addProperty("animation-duration",options.duration),animateClass.addProperty("animation-fill-mode","forwards"),animateClass.addProperty("-webkit-animation-fill-mode","forwards"),style.addClass(animateClass);var animateFrames=new CssAnimation(options.name),keys=Object.keys(options.from),i=0;for(i=0;i<keys.length;i++)animateFrames.from.addProperty(keys[i],options.from[keys[i]]);for(keys=Object.keys(options.to),i=i=0;i<keys.length;i++)animateFrames.to.addProperty(keys[i],options.to[keys[i]]);style.addClass(animateFrames),style.setStyle(),element.removeClass(animateClass.className),element.offsetWidth,element.addClass(animateClass.className)},elem.loadUrl=function(url,data,callback){void 0===this.id&&(this.id="htmlelement_"+RS.String.UUID()),void 0===this.view&&(this.view=new View(this.id)),this.view.loadUrl(url,data,callback)},elem.loadTemplate=function(id,data){void 0===this.id&&(this.id="htmlelement_"+RS.String.UUID()),void 0===this.view&&(this.view=new View(this.id)),this.view.loadTemplate(id,data)},elem.loadHTML=function(html,data){void 0===this.id&&(this.id="htmlelement"+rand()),void 0===this.view&&(this.view=new View(this.id)),this.view.loadHTML(html,data)},elem},RS.Array=function(arr){if(arr.getUnique=function(){for(var u={},a=[],i=0,l=this.length;i<l;++i)u.hasOwnProperty(this[i])||(a.push(this[i]),u[this[i]]=1);return a},arr.encodeUri=function(){var str=JSON.stringify(this);return encodeURIComponent(str)},arr.where=function(item,value){var result=[];return this.forEach(function(obj,index,arr){obj[item]==value&&result.push(obj)}),result},arr.andWhere=function(item,value){var result=[];return this.forEach(function(obj,index,arr){obj[item]==value&&result.push(obj)}),result},arr.first=function(){return this[0]},arr.like=function(item,value){var result=[];return this.forEach(function(obj,index,arr){String(obj[item]).contains(value)&&result.push(obj)}),result},arr.andLike=function(item,value){var result=[];return this.forEach(function(obj,index,arr){String(obj[item]).contains(value)&&result.push(obj)}),result},arr.indexOf=function(item,value){var result=-1;return this.forEach(function(elem,index,arr){elem[item]==value&&(result=index)}),result},arr.contains=function(value){var result=!1;return this.forEach(function(elem,index,self){elem==value&&(result=!0)}),result},void 0===arr.forEach){var self=this;arr.forEach=function(fn){var i,len;for(len=self.length,i=0;i<len;i++)fn(self[i],i,self)}}arr.sortAsc=function(property){if(0!==this.length){var row=this[0];void 0===row[property]&&console.error(property+" no part of object.",this),window.__tempFilter=property;function getValue(v){return Math.isNumeric(v)?1*v:v}return Math.isNumeric(row[property])?this.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter],_b=b[filter];return getValue(_a)-getValue(_b)}):this.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter],_b=b[filter];return _a.localeCompare(_b)})}console.warn("No data to sort",this,property)},arr.sortDesc=function(property){if(0!==this.length){var row=this[0];void 0===row[property]&&console.error(property+" no part of object.",this),window.__tempFilter=property;function getValue(v){return Math.isNumeric(v)?1*v:v}return Math.isNumeric(row[property])?this.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter],_b=b[filter];return getValue(_b)-getValue(_a)}):this.sort(function(a,b){var filter=window.__tempFilter,_a=a[filter];return b[filter].localeCompare(_a)})}console.warn("No data to sort",this,property)},arr.each=function(fn){try{var i,len;for(len=this.length,i=0;i<len;i++)fn(this[i],i,this)}catch(e){if(e!==BreakException)throw e}},arr.sum=function(prop){if(0===this.length)return 0;if("object"==typeof this[0]){if(this[0].hasOwnProperty(prop)){var sum=0;return this.forEach(function(item){sum+=Number(item[prop])}),sum}console.error("Items does not have a "+prop+" property.")}else console.error("Items are not objects")}},RS.DateHelper=function(){this.timestamp=function(){return Math.floor(Date.now()/1e3)},this.getDateParts=function(date){var dateObj=new Date;void 0!==date&&(dateObj=new Date(date));var month=dateObj.getUTCMonth()+1,day=dateObj.getUTCDate(),year=dateObj.getUTCFullYear(),hour=dateObj.getUTCHours(),minutes=dateObj.getUTCMinutes(),seconds=dateObj.getUTCSeconds();month="00"+month,month=String(month).right(2),day="00"+day,day=String(day).right(2),hour="00"+hour,minutes="00"+minutes,seconds="00"+seconds;var newTime=(hour=String(hour).right(2))+":"+(minutes=String(minutes).right(2))+":"+(seconds=String(seconds).right(2)),newDate=year+"/"+month+"/"+day,dateParts={};return dateParts.year=year,dateParts.month=month,dateParts.day=day,dateParts.hour=hour,dateParts.date=newDate,dateParts.minutes=minutes,dateParts.seconds=seconds,dateParts.time=newTime,dateParts},this.diff=function(date1,date2){var seconds=parseFloat(((date2-date1)/1e3).toFixed(2)),minutes=parseFloat((seconds/60).toFixed(2)),hours=parseFloat((minutes/60).toFixed(2)),days=parseFloat((hours/24).toFixed(2)),months=parseFloat((days/30.4167).toFixed(2));return{second:seconds,minute:minutes,hour:hours,day:days,month:months,year:parseFloat((months/12).toFixed(2))}},this.now=function(){return(new Date).getTime()}},RS.Math.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},RS.JSON=function(){this.tryParse=function(str,out){try{return out.data=JSON.parse(str),!0}catch(ex){return!1}}},RS.SessionStorage=function(){};var getAll=function(){var i=0,len=sessionStorage.length,params={};for(i=0;i<len;++i){var itemValue=sessionStorage.getItem(sessionStorage.key(i)),output={};JSON.tryParse(itemValue,output)?params[sessionStorage.key(i)]=output:params[sessionStorage.key(i)]=itemValue}return params},validateWindow=function(){return window};RS.SessionStorage.set=function(itemKey,itemValue){validateWindow()?("object"==typeof itemValue&&(itemValue=JSON.stringify(itemValue)),window.localStorage.setItem(itemKey,itemValue)):console.log("No window. Exit RS.SessionStorage.set")},RS.SessionStorage.remove=function(itemKey){validateWindow()?window.localStorage.removeItem(itemKey):console.log("No window. Exit RS.SessionStorage.remove")},RS.SessionStorage.get=function(itemKey){if(validateWindow()){if(void 0===itemKey)return getAll();if(null===window.localStorage.getItem(itemKey))return console.warn("Item "+itemKey+" do not exists"),null;var output={},itemValue=window.localStorage.getItem(itemKey);return JSON.tryParse(itemValue,output)?output.data:itemValue}console.log("No window. Exit RS.SessionStorage.get")},RS.SessionStorage.exists=function(itemKey){if(validateWindow())return null!==window.localStorage.getItem(itemKey);console.log("No window. Exit RS.SessionStorage.get")},RS.SessionStorage=function(){};getAll=function(){var i=0,len=sessionStorage.length,params={};for(i=0;i<len;++i){var itemValue=sessionStorage.getItem(sessionStorage.key(i)),output={};JSON.tryParse(itemValue,output)?params[sessionStorage.key(i)]=output:params[sessionStorage.key(i)]=itemValue}return params},validateWindow=function(){return window};function CssRule(ruleName){this.ruleName=ruleName,this.properties={}}RS.SessionStorage.set=function(itemKey,itemValue){validateWindow()?("object"==typeof itemValue&&(itemValue=JSON.stringify(itemValue)),window.sessionStorage.setItem(itemKey,itemValue)):console.log("No window. Exit RS.SessionStorage.set")},RS.SessionStorage.remove=function(itemKey){validateWindow()?window.sessionStorage.removeItem(itemKey):console.log("No window. Exit RS.SessionStorage.remove")},RS.SessionStorage.get=function(itemKey){if(validateWindow()){if(void 0===itemKey)return getAll();if(null===window.sessionStorage.getItem(itemKey))return console.warn("Item "+itemKey+" do not exists"),null;var output={},itemValue=window.sessionStorage.getItem(itemKey);return JSON.tryParse(itemValue,output)?output.data:itemValue}console.log("No window. Exit RS.SessionStorage.get")},RS.SessionStorage.exists=function(itemKey){if(validateWindow())return null!==window.sessionStorage.getItem(itemKey);console.log("No window. Exit RS.SessionStorage.get")},RS.Activity=function(config){var self=this;self.containerId=config.containerId,self.url=config.url;var view=new View(self.containerId);self.hide=function(){null===view.content&&(view=new View(self.containerId)),view.content.removeClass("animateclassanimationActivityLeft"),view.content.addClass("animateclassanimationActivityRight")},self.load=function(data){null===view.content&&(view=new View(self.containerId)),void 0===data&&(data=null),view.loadUrl(self.url,data,function(){view.content.removeClass("animateclassanimationActivityRight"),view.content.addClass("animateclassanimationActivityLeft")})}},RS.CookieHelper=function(){var self=this;self.set=function(name,value,days){days=days||1/24;var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3);var cookie=name+"="+value+"; expires="+("expires="+date.toUTCString());document.cookie=cookie},self.delete=function(name){var _cookies=self.get(name);if(null===_cookies)return null;function fnDelete(name){var expiresAt="Thu, 01 Jan 1970 00:00:01 GMT",cookie=name+"=0; expires="+expiresAt;document.cookie=cookie,cookie=name+"=0; path=/;domain="+window.location.host+"; expires="+expiresAt,document.cookie=cookie}if(void 0!==_cookies.length){if(!(0<_cookies.length))return null;_cookies.forEach(function(item,index,collection){fnDelete(item.name)})}else fnDelete(name)},self.get=function(name){if(""===document.cookie)return null;var cookies=document.cookie.split("; "),result=[],isFound=!1,itemResult=null;return cookies.forEach(function(value,index,array){var keyValue=value.split("="),item={};if(item.name=keyValue[0],item.value=keyValue[1],void 0!==name){if(name==item.name)return itemResult=item,void(isFound=!0)}else result.push(item)}),isFound?itemResult:void 0!==name?null:result}},RS.CssAnimation=function(name){this.name=name,this.from=new CssRule("from"),this.to=new CssRule("to")},CssAnimation.prototype.name="",CssAnimation.prototype.from=null,CssAnimation.prototype.to=null,CssAnimation.prototype.toString=function(){var css="@keyframes "+this.name+" {\n@from\n@to\n}",cssFrom=this.from.toString(),cssTo=this.to.toString();cssFrom=cssFrom.replace(".from","from"),cssTo=cssTo.replace(".to","to"),css=(css=css.replace("@from",cssFrom)).replace("@to",cssTo);var wkcss="@-webkit-keyframes "+this.name+" {\n@from\n@to\n}";return css+"\n"+(wkcss=(wkcss=wkcss.replace("@from",cssFrom)).replace("@to",cssTo))},CssRule.prototype.ruleName="",CssRule.prototype.addProperty=function(propertyName,propertyValue){this.properties[propertyName]=propertyValue},CssRule.prototype.toString=function(){var css="."+this.ruleName+" {\n",keys=Object.keys(this.properties),len=keys.length,i=0;for(i=0;i<len;i++)css+=keys[i]+": "+this.properties[keys[i]]+";",css+="\n";return css+="}"},RS.CssStyle=function(){},CssStyle.prototype.classes=[],CssStyle.prototype.addClass=function(cssClass){this.classes.push(cssClass)},CssStyle.prototype.toString=function(){var i,len=this.classes.length,css="";for(i=0;i<len;i++)css+=this.classes[i].toString()+"\n\n";return css},CssStyle.prototype.setStyle=function(){var style=document.createElement("style");style.type="text/css",style.innerHTML=this.toString(),document.getElementsByTagName("head")[0].appendChild(style)},RS.Dialog=function(){this.showAlert=function(msg,title,buttonText){void 0===navigator.notification?alert(msg):navigator.notification.alert(msg,null,title,buttonText)},this.showConfirm=function(msg,onConfirm){null===navigator.notification?onConfirm(confirm(msg)?1:2):navigator.notification.confirm(msg,onConfirm,"Confirmar",["Si","No"])}},RS.Dom=function(){var self=this,arrowUp=" "+RS.Strings.unescapeHTML("&#8679;"),arrowDown=" "+RS.Strings.unescapeHTML("&#8681;");self.submitForm=function(url,data){var form=dom.create("form");Object.keys(data).forEach(function(item,index,collection){var input=function(name,value){var input=dom.create("input");return input.setAttribute("name",name),input.setAttribute("value",value),input}(item,data[item]);form.appendChild(input)}),form.setAttribute("method","post"),form.setAttribute("action",url),document.body.appendChild(form),form.submit(),document.body.removeChild(form)},self.onEnter=function(element,callback){element.onkeyup=function(){13==event.keyCode&&callback()}},self.get=function(selector){var items=document.querySelectorAll(selector);return 1==items.length?items[0]:items},self.getAll=function(selector){return document.querySelectorAll(selector)},self.getById=function(id){return document.getElementById(id)},self.getFile=function(input,fn){var result=null;if(input.files&&input.files[0]){(result={}).name=input.files[0].name,result.type=input.files[0].type,result.size=input.files[0].size,result.inputName=input.name,result.data=null;var reader=new FileReader;reader.onload=function(e){result.data=e.target.result,void 0!==fn&&fn(result)},reader.readAsDataURL(input.files[0])}return result},self.getInputsValues=function(){function fn(val,i,arr){result[val.id]=val.value}var allInputs=document.getElementsByTagName("input"),allSelects=document.getElementsByTagName("select"),result={};return allInputs.forEach(fn),allSelects.forEach(fn),result},self.validateInputs=function(){var inputs=self.get("input"),isValid=!0,msg="";return Array.prototype.forEach.call(inputs,function(value,index,arr){if(isValid=isValid&&value.checkValidity(),!1===value.checkValidity()){var title=value.getAttribute("title");null!==title&&(msg+=title+"\r\n")}}),isValid||dlg.showAlert(msg,"Error","Ok"),isValid},self.getSelect=function(name,data,val,text){var sel=document.createElement("select");sel.id=name,sel.name=name;return data.forEach(function(v,i,a){var opt=document.createElement("option");opt.value=v[val],opt.innerHTML=v[text],sel.appendChild(opt)}),sel},self.populateSelect=function(select,data,valueField,textField,value){null==value&&(value=data[0][valueField]);data.forEach(function(item,key,arr){var option=self.create("option");option.value=item[valueField],option.innerHTML=item[textField],select.appendChild(option)}),select.value=value},self.create=function(nodeName){var element=document.createElement(nodeName);return"undefined"!=typeof rs&&null!=rs.config&&void 0!==rs.config.options.useMVC&&rs.config.options.useMVC&&self.setMVCListener(element),element},self.setMVCListener=function(input){function onChange(){var bindable=this.getAttribute("data-bind");if(null!==bindable){var nodeName=this.nodeName.toLowerCase(),type=this.getAttribute("type"),val=null;if(val="input"==nodeName&&"checkbox"==type?this.checked:this.value,rs.returnValue(bindable)!=val){rs.assignValue(bindable,val);var bindedElements=document.querySelectorAll("[data-bind='"+bindable+"']");bindedElements.length;Array.prototype.forEach.call(bindedElements,function(element,key,arr){"select"==(nodeName=element.nodeName.toLowerCase())?element.value=rs.returnValue(bindable):element.innerHTML=rs.returnValue(bindable)})}}}switch(input.nodeName.toLowerCase()){case"input":switch(input.getAttribute("type")){case"text":case"email":case"password":input.addEventListener("keyup",onChange),input.addEventListener("blur",onChange);break;case"date":case"time":input.addEventListener("change",onChange),input.addEventListener("blur",onChange);break;case"checkbox":case"radio":input.addEventListener("change",onChange)}break;case"textarea":input.addEventListener("keyup",onChange),input.addEventListener("blur",onChange);break;case"select":input.addEventListener("change",onChange)}var bindable=input.getAttribute("data-bind");null!==input.getAttribute("data-bind-mode")&&function(element,bindable){var parts=bindable.split(".");if(1<parts.length){var propName=parts[parts.length-1];parts.pop();var obj=parts.join(".");rs.evalUndefined(obj)&&rs.assignValue(obj,"{}");var privateName="_"+propName;rs.assignValue(obj+"."+privateName,null);rs.defineSetter(obj,propName,function(value){this[privateName]=value,"img"==element.nodeName.toLowerCase()?element.src=value:element!=document.activeElement&&(element.value=value)}),rs.defineGetter(obj,propName,function(){return this[privateName]})}}(input,bindable),rs.assignValue(bindable,null)},self.bindData=function(){var self=this,inputs=document.querySelectorAll("input, textarea, select, img");Array.prototype.forEach.call(inputs,function(input,key,arr){self.setMVCListener(input)});var selectElements=document.querySelectorAll("select[data-source]");Array.prototype.forEach.call(selectElements,function(select,key,arr){var valueField=select.getAttribute("data-value-field"),textField=select.getAttribute("data-display-field"),dataSource=select.getAttribute("data-source"),dataBind=select.getAttribute("data-bind");dataSource=rs.returnValue(dataSource);var selectValue=rs.returnValue(dataBind);self.populateSelect(select,dataSource,valueField,textField,selectValue)});var bindedElements=document.querySelectorAll("[data-bind],[data-source]");bindedElements.length;Array.prototype.forEach.call(bindedElements,function(element,key,arr){var nodeName=element.nodeName.toLowerCase(),bindable=element.getAttribute("data-bind"),dataRepeater=element.getAttribute("data-repeater");if("select"==nodeName||"input"==nodeName||"textarea"==nodeName){if(!rs.evalUndefined(bindable)){var val=rs.returnValue(bindable);null!==val&&(element.value=val)}}else if("img"==nodeName)element.src=rs.returnValue(bindable);else if("table"==nodeName){if(bindable=element.getAttribute("data-source"),!rs.evalUndefined(bindable)){var ths=element.querySelectorAll("tr > th"),options={},columns=[],column={};null!==element.getAttribute("class")&&(options.class=element.getAttribute("class"));ths.forEach(function(th,i,ths){column={};var type=th.getAttribute("data-field-type");switch(column.type=type){case"text":case"textbox":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),columns.push(column);break;case"select":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),column.source=th.getAttribute("data-source"),column.valueField=th.getAttribute("data-value-field"),column.displayField=th.getAttribute("data-display-field"),columns.push(column);break;case"hyperlink":column.name=th.getAttribute("data-field"),column.header=th.getAttribute("data-header"),column.urlFormatFields=th.getAttribute("data-url-fields"),column.text=th.getAttribute("data-text"),column.urlFormat=th.getAttribute("data-url-format"),column.onclickFormatFields=th.getAttribute("data-onclick-fields"),column.onclickFormat=th.getAttribute("data-onclick-format"),null!==column.onclickFormatFields&&(column.onclickFormatFields=column.onclickFormatFields.split(",")),null!==column.urlFormatFields&&(column.urlFormatFields=column.urlFormatFields.split(",")),columns.push(column)}}),element.clear();var data=rs.returnValue(bindable);options.columns=columns;var newTable=self.getTableFromData(data,options);self.replaceTable(element,newTable)}}else if("true"==dataRepeater){if(null===(data=rs.returnValue(element.getAttribute("data-source"))))return void console.error("DataRepeater.data is null");var temp=(new View).populateElement(element.firstElementChild,data);element.clear(),temp.constructor.toString().contains("Array")?temp.forEach(function(item){element.append(item)}):element.append(temp)}else element.innerHTML=rs.returnValue(bindable)})},self.replaceTable=function(table,newTable){table.parentNode.replaceChild(newTable,table)},self.bind=function(variableName){var bindedElements=document.querySelectorAll("[data-bind]");bindedElements.length;Array.prototype.forEach.call(bindedElements,function(element,key,arr){var nodeName=element.nodeName.toLowerCase(),bindable=element.getAttribute("data-bind");bindable==variableName&&(rs.evalUndefined(bindable)||("select"==nodeName||"input"==nodeName||"textarea"==nodeName?element.value=rs.returnValue(bindable):element.innerHTML=rs.returnValue(bindable)))})},self.addModel=function(name,data){function fn(name){console.log(name+" has changed")}"RSObject"!=data.constructor&&(data=new RSObject(data));data.forEach(function(value,key,obj){watcher.add(name+"."+key,fn)}),window[name]=data},self.getTableFromData=function(data,options){function _forEachCell(fn){var arr=this.cells,i=0;for(i=0;i<arr.length;i++)fn(arr[i],i,arr)}if(void 0===data)return console.error("Table data is undefined"),void dlg.showAlert("Los datos no estan definidos","Error","Ok");if(0==data.length)return dom.create("table");var table=self.create("table");table.forEachRow=function(fn){var arr=this.rows,i=0;for(i=0;i<arr.length;i++)fn(arr[i],i,arr)},table.checkedRows=function(){var rows=[];return this.forEachRow(function(row,index,arr){row.forEachCell(function(cell,cellIndex,cellArray){cell.childNodes.forEach(function(node,nodeIndex,nodeArray){"checkbox"==node.type&&node.checked&&rows.push(row)})})}),rows},table.sort=function(property,ascDesc){void 0===ascDesc&&(ascDesc="asc")},void 0!==options&&(void 0!==options.class&&table.addClass(options.class),void 0!==options.id&&(table.id=options.id));function fnEachColumn(item,index,array){(th=self.create("th")).setAttribute("data-sort","asc"),th.style.cursor="pointer";var text=item+arrowUp;void 0!==item.name&&(text=item.name+arrowUp),void 0!==item.header&&(text=item.header+arrowUp),th.addText(text),th.addEventListener("click",function(){var sort=this.getAttribute("data-sort"),arrow="",sortColumn=item;void 0!==item.name&&(sortColumn=item.name),"asc"==sort?(sort="desc",arrow=arrowDown,data.sortDesc(sortColumn)):(sort="asc",arrow=arrowUp,data.sortAsc(sortColumn)),this.setAttribute("data-sort",sort),sortColumn+=arrow,void 0!==item.header&&(sortColumn=item.header+arrow),this.innerText=sortColumn,function(){for(table.rows.length;1<table.rows.length;)table.deleteRow(1)}(),data.forEach(fnEachRow)}),tr.appendChild(th)}var firstRow=data[0],keys=Object.keys(firstRow),th=null,fnEachRow=function(obj,i,arr){function fnEach(item,index,array){var td=self.create("td");td.addText(obj[item]),tr.appendChild(td)}if((tr=self.create("tr")).forEachCell=_forEachCell,tr.data=obj,void 0!==options&&void 0!==options.onclick){tr.addEventListener("click",function(){options.onclick(obj)})}void 0!==options&&void 0!==options.columns?options.columns.forEach(function(item,index,array){var row=obj,td=self.create("td");switch(item.type){case"checkbox":var checkbox=self.create("input");checkbox.type="checkbox",checkbox.id=item.name+"_"+i,checkbox.value=row[item.name],td.appendChild(checkbox);break;case"text":void 0!==item.transform&&"function"==typeof item.transform?td.addText(item.transform(row[item.name])):void 0!==options.isNull?null===row[item.name]&&td.addText(options.isNull):td.addText(row[item.name]);break;case"textbox":var textbox=self.create("input");textbox.type="text",textbox.value=row[item.name],td.appendChild(textbox);break;case"select":break;case"hyperlink":var hyperlink=self.create("a"),dataTextFormat=item.dataTextFormat,dataTextFormatFields=item.dataTextFormatFields,linkText=item.text;if(void 0===item.text&&null!=dataTextFormat)if(null!=dataTextFormatFields){var fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;dataTextFormat=dataTextFormat.replace(toFind,row[fieldName])};dataTextFormatFields.forEach(fnEach),linkText=dataTextFormat}else linkText=dataTextFormat;hyperlink.appendChild(document.createTextNode(linkText));var urlFormat=item.urlFormat,urlFormatFields=item.urlFormatFields,url="#";if(null!=urlFormat)if(null!=urlFormatFields){fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;urlFormat=urlFormat.replace(toFind,row[fieldName])};urlFormatFields.forEach(fnEach),url=urlFormat}else url=urlFormat;hyperlink.href=url;var onclickFormat=item.onclickFormat,onclickFormatFields=item.onclickFormatFields,onclick="";if(null!=onclickFormat)if(null!=onclickFormatFields){fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;onclickFormat=onclickFormat.replace(toFind,row[fieldName])};onclickFormatFields.forEach(fnEach),onclick=onclickFormat}else onclick=onclickFormat;hyperlink.setAttribute("onclick",onclick),td.appendChild(hyperlink);break;case"hidden":var hidden=self.create("input");hidden.type="hidden",hidden.value=row[item.name],td.appendChild(hidden);break;case"textarea":var textarea=self.create("textarea");textarea.value=row[item.name],td.appendChild(textarea);break;case"image":var img=self.create("img");if(urlFormat=item.urlFormat,urlFormatFields=item.urlFormatFields,url="#",null!==urlFormat)if(null!==urlFormatFields){fnEach=function(fieldName,index,fields){var toFind="@"+fieldName;urlFormat=urlFormat.replace(toFind,row[fieldName])};urlFormatFields.forEach(fnEach),url=urlFormat}else url=urlFormat;img.src=url,img.style.height=item.height,img.style.width=item.width,td.appendChild(img)}tr.appendChild(td)}):keys.forEach(fnEach),void 0!==options&&void 0!==options.backgroundColorField&&(tr.style.backgroundColor=obj[options.backgroundColorField]),table.appendChild(tr)},tr=self.create("tr");return tr.setAttribute("data-rowheader",!0),tr.forEachCell=_forEachCell,tr.data=keys,void 0!==options&&void 0!==options.columns?options.columns.forEach(fnEachColumn):keys.forEach(fnEachColumn),table.appendChild(tr),data.forEach(fnEachRow),table},self.setDataTable=function(id,data,options){var tableParent=dom.getById(id);null==tableParent&&console.error(tableParent+" do not exists");var table=self.getTableFromData(data,options);return tableParent.clear(),table.addClass("table table-hover"),tableParent.appendChild(table),table},self.DataTable=function(containerId,data,options){return self.setDataTable(containerId,data,options)}},window.dom=new Dom,RS.BreakException={},RS.Exception=function(message,reference){this.message=message,this.reference=reference},RS.GeoPosition=function(){new Dialog,new Local;this.Lat=0,this.Lng=0,this.LatLng=null,this.Geocode=[],this.StreetNumber="",this.Route="",this.SubLocality="",this.City="",this.State="",this.Country="",this.PostalCode="",this.Address=""},RS.Geo=function(){var fn=null;this.onError=function(error){dlg.showAlert("Hubo problemas obteniendo la posicion")},this.onSuccessGetPosition=function(position){local.remove("currentGeoPosition");var geoPos=new RS.GeoPosition;geoPos.Lat=parseFloat(position.coords.latitude),geoPos.Lng=parseFloat(position.coords.longitude),geoPos.LatLng=new google.maps.LatLng(geoPos.Lat,geoPos.Lng),this.coder=new google.maps.Geocoder,this.coder.geocode({latLng:geoPos.LatLng},function(results,status){if(status==google.maps.GeocoderStatus.OK)if(results[0]){var arrAddress=results[0].address_components,i=0;for(i=0;i<arrAddress.length;i++)switch(arrAddress[i].types[0]){case"street_number":geoPos.StreetNumber=arrAddress[i].long_name;break;case"route":geoPos.Route=arrAddress[i].long_name;break;case"sublocality_level_1":geoPos.SubLocality=arrAddress[i].long_name;break;case"locality":geoPos.City=arrAddress[i].long_name;break;case"administrative_area_level_1":geoPos.State=arrAddress[i].long_name;break;case"country":geoPos.Country=arrAddress[i].long_name;break;case"postal_code":geoPos.PostalCode=arrAddress[i].long_name}geoPos.Address=geoPos.Route+", "+geoPos.StreetNumber+", "+geoPos.SubLocality+", "+geoPos.City+", "+geoPos.State+", "+geoPos.Country,local.set("currentGeoPosition",JSON.stringify(geoPos)),fn(geoPos)}else dlg.showAlert("No results found","Error","Ok");else dlg.showAlert("Geocoder failed due to: "+status,"Error","Ok")})},this.getPositionAddress=function(callBack){fn=callBack,navigator.geolocation.getCurrentPosition(this.onSuccessGetPosition,this.onError)}},RS.KeyValuePair=function(key,value){this.key=key,this.value=value},RS.Hashtable=function(){var table=[];this.insert=function(key,value){var hash=function(key){var len=key.length,chars=key.split(""),number=0;return chars.forEach(function(c){number+=c.charCodeAt(0)}),number=Math.ceil(number/len)}(key);table.push(hash)}},RS.Http=function(){var self=this,dom=new Dom,headers=new RSObject;this.setHeader=function(key,value){headers[key]=value},this.getHeaders=function(){return headers},this.clearHeaders=function(){headers={}},this.get=function(url,data){return self.request("GET",url,data)},this.post=function(url,data){return self.request("POST",url,data)},this.put=function(url,data){return self.request("PUT",url,data)},this.delete=function(url,data){return self.request("DELETE",url,data)},this.head=function(url,data){return self.request("HEAD",url,data)},this.postMultiPart=function(form){return new RSPromise(function(resolve,reject){var xhttp=new XMLHttpRequest;xhttp.open("post",form.action,!0),xhttp.onreadystatechange=function(){if(4==xhttp.readyState)if(200==xhttp.status){var res={headers:{}},headers=xhttp.getAllResponseHeaders();(headers=headers.split("\n")).forEach(function(item,index,collection){if(""!==item){var parts=item.split(": ");res.headers[parts[0].trim()]=parts[1].trim()}}),res.status=xhttp.status,"application/json"==res.headers["Content-Type"]?res.data=JSON.parse(xhttp.response):res.data=xhttp.response,resolve(res)}else reject(xhttp)};var formData=new FormData(form);xhttp.send(formData)})},this.request=function(method,url,data){return new RSPromise(function(resolve,reject){var localOnError=null;localOnError=void 0===reject?function(statusText){console.error(statusText)}:reject;function setHeaders(){headers.forEach(function(value,key,obj){xhttp.setRequestHeader(key,value)})}var xhttp=new XMLHttpRequest,toPost=null,isBinary=!(xhttp.onreadystatechange=function(){if(4==xhttp.readyState)if(200==xhttp.status){var res={headers:{}},headers=xhttp.getAllResponseHeaders();(headers=headers.split("\n")).forEach(function(item,index,collection){if(""!==item){var parts=item.split(": ");res.headers[parts[0].trim().toLowerCase()]=parts[1].trim()}}),res.status=xhttp.status,res.headers["content-type"].contains("application/json")?res.data=JSON.parse(xhttp.response):res.data=xhttp.response,resolve(res)}else localOnError(xhttp)});null!=data&&(String(data.constructor).contains("function File()")?(toPost=data,isBinary=!0):toPost=(data=new RSObject(data)).serialize()),"GET"==method?(""!==toPost&&null!==toPost&&(url=url+"?"+toPost),xhttp.open(method,url,!0),setHeaders(),xhttp.send()):(xhttp.open(method,url,!0),isBinary?(setHeaders(),xhttp.setRequestHeader("Content-type","multipart/form-data; boundary=blob")):(xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),setHeaders()),xhttp.send(toPost))})},self.downloadFile=dom.submitForm},window.http=new Http,RS.Modal=function(){var divTitle,divMessage,divButton,self=this,divModal=dom.getById("modalContainer"),divModalContent=dom.getById("modalContent");self.getContainer=function(){return divModal};function fnLoadModal(){null===divModal&&((divModal=dom.create("div")).id="modalContainer",divModal.addClass("modal")),null===divModalContent&&((divModalContent=dom.create("div")).id="modalContent",divModalContent.addClass("modalContent"),divModal.appendChild(divModalContent)),null===dom.getById("modalContainer")&&dom.get("body").appendChild(divModal)}rs.onReady(fnLoadModal),(self=this).trimereet="",self.showUrl=function(url,data){null===divModal&&fnLoadModal(),divModalContent.style.width="70%",divModalContent.style.height="70vh",divModalContent.style.marginTop="20vh",divModalContent.clear();var view=new View("modalContent");null!=data?view.loadUrl(url,data):view.loadUrl(url),divModal.style.display="block"},self.showTemplate=function(templateId,data){null===divModal&&fnLoadModal(),divModalContent.style.width="70%",divModalContent.style.height="70vh",divModalContent.style.marginTop="20vh",divModalContent.style.padding="1vh",divModalContent.clear();var template=dom.getById(templateId),temp="";void 0!==data?temp=(new View).populateTemplate(template.innerHTML,data):temp=template.innerHTML;divModalContent.innerHTML=temp,divModal.style.display="block"},self.showInfo=function(message,title,buttonText){null===divModal&&fnLoadModal(),void 0===title&&(title="Info"),void 0===buttonText&&(buttonText="Ok"),divModalContent.style.width="80%",divModalContent.style.height="40%",divModalContent.style.marginTop="40%",divModalContent.style.padding="10px",divModalContent.clear(),(divTitle=dom.create("div")).style.height="25%",divTitle.style.width="100%",divTitle.style.float="left",divTitle.innerHTML=title,(divMessage=dom.create("div")).style.height="50%",divMessage.style.width="100%",divMessage.style.float="left",divMessage.innerHTML=message,(divButton=dom.create("div")).style.height="25%",divButton.style.width="50%",divButton.style.float="right",divButton.addClass("button"),divButton.addClass("go"),divButton.onclick=function(){self.hide()},divButton.innerHTML=buttonText,divModalContent.appendChild(divTitle),divModalContent.appendChild(divMessage),divModalContent.appendChild(divButton),divModal.style.display="block"},self.showWait=function(message){null===divModal&&fnLoadModal(),divModalContent.style.width="80%",divModalContent.style.height="20vh",divModalContent.style.marginTop="40vh",divModalContent.style.padding="4vh",divModalContent.clear(),void 0===message&&(message="Espere, por favor");var txt=document.createTextNode(message),img=document.createElement("img");img.src="img/preloader.gif",img.style.width="90%",img.style.marginLeft="5%",img.style.float="left",divModalContent.appendChild(txt),divModalContent.appendChild(document.createElement("br")),divModalContent.appendChild(document.createElement("br")),divModalContent.appendChild(img),divModal.style.display="block"},self.hide=function(){null===divModal&&fnLoadModal(),divModal.style.display="none",divModalContent.clear()}};var modal=new Modal;RS.Observable=function(subscribe){var self=this;self._subscribe=subscribe,self.subscribe=function(next,error,complete){void 0===error&&(error=null),void 0===complete&&(complete=null);var observer=new Observer(next,error,complete);return observer._unsubscribe=self._subscribe(observer),{unsubscribe:function(){observer.unsubscribe()}}},self.map=function(transformFunction){return new Observable(function(observer){return self.subscribe(function(value){observer.next(transformFunction(value))},function(err){observer.error(err)},function(){observer.complete()}).unsubscribe})}},RS.Observable.of=function(){var args=arguments;return new Observable(function(observer){return RS.forEach(args,function(arg){observer.next(arg)}),observer.complete(),function(){console.log("Observable from: unsubscribe")}})},RS.Observable.from=function(values){return new Observable(function(observer){return RS.forEach(values,function(value){observer.next(value)}),observer.complete(),function(){console.log("Observable from: unsubscribed")}})},RS.Observable.fromEvent=function(element,eventName){return new Observable(function(observer){function eventHandler(event){observer.next(event)}return element.addEventListener(eventName,eventHandler,!1),function(){element.removeEventListener(eventName,eventHandler,!1),console.log("Observable.fromEvent: Unsubscribe")}})},RS.Observer=function(next,error,complete){void 0===error&&(error=null),void 0===complete&&(complete=null);var self=this;if(self.isCompleted=!1,self.isSubscribed=!0,!next)throw new Exception("RealSimpleJS.Observer: First argument must be present");"object"==typeof next&&next.hasOwnProperty("next")&&next.hasOwnProperty("error")&&next.hasOwnProperty("complete")&&(error=next.error,complete=next.complete,next=next.next),self.next=function(value){self.isCompleted?console.info("INFO: RealSimpleJS.Observer: Observable already completed"):self.isSubscribed?next(value):console.info("INFO: RealSimpleJS.Observer: Not subscribed anymore")},self.error=function(err){self.isCompleted?console.info("INFO: RealSimpleJS.Observer: Observable already completed"):self.isSubscribed?error&&(error(err),self.unsubscribe()):console.info("INFO: RealSimpleJS.Observer: Not subscribed anymore")},self.complete=function(){self.isCompleted?console.info("INFO: RealSimpleJS.Observer: Observable already completed"):self.isSubscribed?complete&&(complete(),self.isCompleted=!0,self.unsubscribe()):console.info("INFO: RealSimpleJS.Observer: Not subscribed anymore")},self.unsubscribe=function(){self.isSubscribed=!1,self._unsubscribe&&self._unsubscribe()}},RS.PubSub=function(){this.channels={},this.subscribe=function(channel,onPublish){this.channels[channel]||(this.channels[channel]=[]),this.channels[channel].push(onPublish)},this.publish=function(channel,data){!this.channels[channel]||this.channels[channel].length<1||this.channels[channel].forEach(function(onPublish){onPublish(data||{})})}},RS.Restful=function(resourceUrl){var http=new Http,self=this,responseHandler=null,match=/:\b[a-z]+/g.exec(resourceUrl);if(void 0!==match&&0<match.length){var key=(match=match[0]).replace(":","");resourceUrl=void 0!==self[key]?resourceUrl.replace(match,self[key]):resourceUrl.replace(match,"")}function setData(){var data={};return Object.keys(self).forEach(function(key,index,arr){var value=self[key];"function"!=typeof value&&(data[key]=value)}),data}function onGet(response){if("object"==typeof response)if(response instanceof Array){if(void 0!==responseHandler){var collection=function(response){var result=[];return response.forEach(function(item,index,arr){var r=new window.Restful(resourceUrl);item.forEach(function(value,key,obj){r[key]=value}),result.push(r)}),result}(response);responseHandler(collection),responseHandler=null}}else response.forEach(function(value,key,obj){self[key]=value});else console.error("Response is neither Array nor Object.")}this.get=function(fnResponse){void 0!==fnResponse&&(responseHandler=fnResponse),http.get(resourceUrl,null,onGet)},this.post=function(){var data=setData();http.post(resourceUrl,data,onRequest)},this.put=function(){var data=setData();http.put(resourceUrl,data,onRequest)},this.delete=function(){var data=setData();http.delete(resourceUrl,data,onRequest)},this.head=function(){var data=setData();http.head(resourceUrl,data,onRequest)}},function(){function isRSPromise(obj){return void 0!==obj&&obj.constructor===self.constructor}function setState(promise,state,val){promise.state===States.PENDING&&promise.state!==state&&States.validate(state)&&(promise.state=state,promise.value=val,promise.state===States.REJECTED&&console.error(promise.value),promise.processQueue())}var States={PENDING:"pending",FULLFILED:"fullfiled",REJECTED:"rejected",validate:function(state){return"pending"==state||"fullfiled"==state||"rejected"==state}};RS.Promise=function(functionPromise){var self=this;self.promiseQueue=[],self.onFullfilled=null,self.onRejected=null,self.state=States.PENDING,self.value=null,self.then=function(onFullfilled,onRejected){var promiseToQueue=new RSPromise;return void 0!==onFullfilled&&(promiseToQueue.onFullfilled=onFullfilled),"undefined"!=typeof onReject&&(promiseToQueue.onRejected=onRejected),self.promiseQueue.push(promiseToQueue),self.processQueue(),promiseToQueue};function fulfillBackfall(val){return val}function rejectBackfall(err){throw err}function loopQueue(){for(;0<self.promiseQueue.length;){var currentPromise=self.promiseQueue.shift(),promiseHandler=fulfillBackfall;self.state==States.FULLFILED&&null!==currentPromise.onFulfilled&&(promiseHandler=currentPromise.onFullfilled),self.state==States.REJECTED&&(promiseHandler=rejectBackfall,null!==currentPromise.onRejected&&(promiseHandler=currentPromise.onRejected));var returnedValue=null;try{returnedValue=promiseHandler(self.value)}catch(ex){setState(currentPromise,States.Rejected,ex);continue}resolve(currentPromise,returnedValue)}}self.processQueue=function(){self.state!=States.PENDING&&setTimeout(loopQueue,0)};var resolve=function(promise,value){if(promise!==value){if(isRSPromise(value))return value.state===States.PENDING?void value.then(function(val){resolve(promise,val)},function(err){setState(promise,States.REJECTED,err)}):void setState(promise,value.state,value.value);if("object"!=typeof value&&"function"!=typeof value)setState(promise,States.FULLFILED,value);else{var thenHandler=null;try{thenHandler=value.then}catch(ex){setState(promise,States.REJECTED,ex)}if("function"!=typeof thenHandler)return void setState(promise,States.FULLFILED,value);var isCalled=!1;try{value.then.call(value,function(y){isCalled||(resolve(promise,y),isCalled=!0)},function(r){isCalled||(setState(promise,States.REJECTED,r),isCalled=!0)})}catch(ex){isCalled||setState(promise,States.REJECT,ex)}}}else setState(promise,States.REJECTED,new TypeError("Promise and value are the same"))};functionPromise&&functionPromise(function(value){resolve(self,value)},function(error){setState(self,States.REJECTED,error)})}}(),RS.Subject=function(){var self=this;self.subscriptions=[],self.isCompleted=!1,self.subscribe=function(next,error,complete){void 0===error&&(error=null),void 0===complete&&(complete=null),self.subscriptions.push({next:next,error:error,complete:complete})},self.next=function(value){self.isCompleted||RS.forEach(self.subscriptions,function(subscription){try{subscription.next(value)}catch(err){subscription.error(err)}})},self.complete=function(){RS.forEach(self.subscriptions,function(subscription){try{subscription.complete&&subscription.complete()}catch(err){subscription.error(err)}}),self.isCompleted=!0}},RS.Validations=function(){function validateType(value,type,i){if(void 0===i&&(i=-1),null!==type){if("function"!=typeof type&&"object"!=typeof type){if(typeof value!=type)throw new Exception("Different type at index position "+i," validateArgumentsTypes")}else if(value.constructor!=type)throw new Exception("Different constructor at index position "+i," validateArgumentsTypes")}else if(null!==value)throw new Exception("Argument "+i+" different type. It can be null also","validateArguentTypes")}var self=this;self.args=function(_args,number,types){!function(args,quantity){if(args.length!=quantity)throw new Exception("Must set "+quantity+" arguments",this)}(_args,number),function(args,types){var i=0;for(i=0;i<args.length;i++){var type=types[i],value=args[i];if("[object Array]"!==Object.prototype.toString.call(type))validateType(value,type,i);else{var count=0,exception=null;if(type.forEach(function(item,index){try{self.validateType(value,item,i)}catch(ex){if(ex instanceof Exception)return exception=ex,void count++;console.error(ex)}}),type.length==count)throw exception}}}(_args,types)};var queue=[];self.add=function(obj,options,message){return queue.push([obj,options,message]),self},self.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},self.isFunction=function(fn){return fn&&"[object Function]"===Object.prototype.toString.call(fn)},self.validate=function(){return 0===queue.length||(queue.forEach(function(item,index){if(!self.isArray(item))throw queue=[],new Exception("Item is not an array","Validations.validate.isArray");if(3!=item.length)throw queue=[],new Exception("The rule has more or less than three arguments. Only a value, a name and a set of rules are necessary","Validations.validate");var val=item[0],message=item[2],rules=item[1];if(self.isFunction(rules)&&(rules=[rules]),!self.isArray(rules))throw new Exception("Rules is not an array","Validations.validate.Rules.isArray");rules.forEach(function(rule){rule(val,message)})}),queue=[]),!0}},RS.Validations.RULES={REQUIRED:function(obj,message){if(null==obj)throw queue=[],void 0===message&&(message=String(obj)+" is required"),new Exception(message,"Validations.REQUIRED");return!0},NONEMPTY:function(obj,message){if(""==obj||null==obj)throw queue=[],void 0===message&&(message=String(obj)+" is empty"),new Exception(message,"Validations.NONEMPTY");return!0},NUMERIC:function(obj,message){if(!Math.isNumeric(obj))throw queue=[],void 0===message&&(message=String(obj)+" is not numeric"),new Exception(message,"Validations.NUMERIC");return!0},INTEGER:function(obj,message){if(!Number.isInteger(obj))throw queue=[],void 0===message&&(message=String(obj)+" is not integer"),new Exception(message,"Validations.INTEGER");return!0},EMAIL:function(obj,message){if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(obj))throw queue=[],void 0===message&&(message=String(obj)+" is not EMAIL"),new Exception(message,"Validations.EMAIL");return!0}},RS.View=function(id){var self=this,dom=new RS.Dom;self.contentId=id,self.content=dom.getById(self.contentId),self.httpR=null,self.setHttp=function(){null===this.httpR&&("undefined"!=typeof http?this.httpR=http:this.httpR=new Http)},self.setHttp(),self.setContent=function(){self.content=dom.getById(self.contentId)},self.loadUrl=function(url,data){return new RSPromise(function(resolve,reject){return self.setContent(),null===data||"undefined"==typeof date?data=new RSObject(data):data.constructor.toString().contains("Object")&&(data=new RSObject(data)),self.httpR.post(url,data).then(function(response){var template=String(response.data);template=self.populateTemplate(template,data),self.content.innerHTML=template,dom.bindData(),void 0!==resolve&&resolve()})})},self.loadTemplate=function(id,data){null===data?data=new RSObject(data):data.constructor.toString().contains("Object")&&(data=new RSObject(data));var html=dom.getById(id).innerHTML;self.loadHTML(html,data),dom.bindData()},self.loadHTML=function(html,data){self.setContent(),html=self.populateTemplate(html,data),self.content.innerHTML=html,dom.bindData()},self.populateElement=function(el,data){if(null!=data){if(void 0!==data.length){var result=[];return data.forEach(function(item,index,collection){result.push(self.populateElement(el,item))}),result}if(null!==data){data=new RSObject(data);var copyEl=el.cloneNode(!0);return copyEl.dataItem=data,copyEl.querySelectorAll("[data-bind]").forEach(function(element){var dataBind=element.getAttribute("data-bind"),nodeName=element.nodeName.toLowerCase();"div"!=nodeName&&"span"!=nodeName||(element.innerHTML=data[dataBind])}),copyEl}}},self.populateTemplate=function(template,data){if(null!=data){if(void 0!==data.length){var result="";return data.forEach(function(item,index,collection){result+=self.populateTemplate(template,item)}),result}if(null!==data){data=new RSObject(data);var jsonString=JSON.stringify(data);jsonString=jsonString.encodeUri(),template=template.replaceAll("$itemJson",jsonString);data.forEach(function(value,key,obj){var find="$"+key;template=template.replaceAll(find,value)})}}var reg=new RegExp("\\$[a-zA-Z0-9]+","gi"),variables=template.match(reg);return null!==variables&&variables.forEach(function(item,index,collection){var varName=item.replace("$","");void 0!==window[varName]&&(template=template.replaceAll(item,window[varName]))}),template}};